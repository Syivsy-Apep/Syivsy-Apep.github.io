<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"syivsy-apep.github.io","root":"/","scheme":"Pisces","version":"8.0.0-rc.5","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™">
<meta property="og:url" content="https://syivsy-apep.github.io/index.html">
<meta property="og:site_name" content="Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Syivsy-Apep">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://syivsy-apep.github.io/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Syivsy-Apep</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">
      

      
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syivsy-apep.github.io/2022/07/25/%E5%B8%B8%E7%94%A8JavaScript%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0%E6%95%B4%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Syivsy-Apep">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/25/%E5%B8%B8%E7%94%A8JavaScript%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0%E6%95%B4%E7%90%86/" class="post-title-link" itemprop="url">å¸¸ç”¨JavaScriptå·¥å…·å‡½æ•°æ•´ç†</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-07-25 11:59:23" itemprop="dateCreated datePublished" datetime="2022-07-25T11:59:23+08:00">2022-07-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-07-26 11:36:03" itemprop="dateModified" datetime="2022-07-26T11:36:03+08:00">2022-07-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81/" itemprop="url" rel="index"><span itemprop="name">å¸¸ç”¨ä»£ç </span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="1-æ•°ç»„"><a href="#1-æ•°ç»„" class="headerlink" title="1.æ•°ç»„"></a>1.æ•°ç»„</h2><h3 id="1-1-æ‰å¹³åŒ–å¤šå…ƒæ•°ç»„æˆ–æ ‘ç»“æ„"><a href="#1-1-æ‰å¹³åŒ–å¤šå…ƒæ•°ç»„æˆ–æ ‘ç»“æ„" class="headerlink" title="1.1 æ‰å¹³åŒ–å¤šå…ƒæ•°ç»„æˆ–æ ‘ç»“æ„"></a>1.1 æ‰å¹³åŒ–å¤šå…ƒæ•°ç»„æˆ–æ ‘ç»“æ„</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;æ‰å¹³åŒ–æ ‘ç»“æ„æ•°æ®</span><br><span class="line">const deepFlatten &#x3D; arr &#x3D;&gt; [].concat(...arr.map(v &#x3D;&gt; Array.isArray(v.children) ? [v].concat(...deepFlatten(v.children)) : v));</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;æ‰å¹³åŒ–å¤šå…ƒæ•°ç»„</span><br><span class="line">const deepFlatten &#x3D; arr &#x3D;&gt; [].concat(...arr.map(v &#x3D;&gt; (Array.isArray(v) ? deepFlatten(v) : v)));</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; æŒ‡å®šæ·±åº¦</span><br><span class="line">const flatten &#x3D; (arr, depth &#x3D; 1) &#x3D;&gt; arr.reduce((a, v) &#x3D;&gt; a.concat(depth &gt; 1 &amp;&amp; Array.isArray(v) ? flatten(v, depth - 1) : v), []);</span><br><span class="line"></span><br><span class="line">flatten([1, [2], 3, 4]); &#x2F;&#x2F; [1, 2, 3, 4]</span><br><span class="line">flatten([1, [2, [3, [4, 5], 6], 7], 8], 2); &#x2F;&#x2F; [1, 2, 3, [4, 5], 6, 7, 8]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="1-2-çº¦ç­‰äº"><a href="#1-2-çº¦ç­‰äº" class="headerlink" title="1.2 çº¦ç­‰äº"></a>1.2 çº¦ç­‰äº</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const approximatelyEqual &#x3D; (v1, v2, epsilon &#x3D; 0.001) &#x3D;&gt; Math.abs(v1 - v2) &lt; epsilon;</span><br><span class="line"></span><br><span class="line">approximatelyEqual(Math.PI &#x2F; 2.0, 1.5708); &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<h3 id="1-3-å¹³å‡æ•°"><a href="#1-3-å¹³å‡æ•°" class="headerlink" title="1.3 å¹³å‡æ•°"></a>1.3 å¹³å‡æ•°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const average &#x3D; (...nums) &#x3D;&gt; nums.reduce((acc, val) &#x3D;&gt; acc + val, 0) &#x2F; nums.length;</span><br><span class="line">average(...[1, 2, 3]); &#x2F;&#x2F; 2</span><br><span class="line">average(1, 2, 3); &#x2F;&#x2F; 2</span><br></pre></td></tr></table></figure>

<h3 id="1-4-æ‹†åˆ†æ–­è¨€åçš„æ•°ç»„"><a href="#1-4-æ‹†åˆ†æ–­è¨€åçš„æ•°ç»„" class="headerlink" title="1.4 æ‹†åˆ†æ–­è¨€åçš„æ•°ç»„"></a>1.4 æ‹†åˆ†æ–­è¨€åçš„æ•°ç»„</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const bifurcate &#x3D; (arr, filter) &#x3D;&gt;</span><br><span class="line">  arr.reduce((acc, val, i) &#x3D;&gt; (acc[filter[i] ? 0 : 1].push(val), acc), [[], []]);</span><br><span class="line">bifurcate([&#39;beep&#39;, &#39;boop&#39;, &#39;foo&#39;, &#39;bar&#39;], [true, true, false, true]); </span><br><span class="line">&#x2F;&#x2F; [ [&#39;beep&#39;, &#39;boop&#39;, &#39;bar&#39;], [&#39;foo&#39;] ]</span><br></pre></td></tr></table></figure>

<h3 id="1-5-å»é™¤æ•°ç»„ä¸­çš„æ— æ•ˆ-æ— ç”¨å€¼"><a href="#1-5-å»é™¤æ•°ç»„ä¸­çš„æ— æ•ˆ-æ— ç”¨å€¼" class="headerlink" title="1.5 å»é™¤æ•°ç»„ä¸­çš„æ— æ•ˆ/æ— ç”¨å€¼"></a>1.5 å»é™¤æ•°ç»„ä¸­çš„æ— æ•ˆ/æ— ç”¨å€¼</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const compact &#x3D; arr &#x3D;&gt; arr.filter(Boolean);</span><br><span class="line"></span><br><span class="line">compact([0, 1, false, 2, &#39;&#39;, 3, &#39;a&#39;, &#39;e&#39; * 23, NaN, &#39;s&#39;, 34]); </span><br><span class="line">&#x2F;&#x2F; [ 1, 2, 3, &#39;a&#39;, &#39;s&#39;, 34 ]</span><br></pre></td></tr></table></figure>

<h3 id="1-6-æ£€æµ‹æ•°å€¼å‡ºç°æ¬¡æ•°"><a href="#1-6-æ£€æµ‹æ•°å€¼å‡ºç°æ¬¡æ•°" class="headerlink" title="1.6 æ£€æµ‹æ•°å€¼å‡ºç°æ¬¡æ•°"></a>1.6 æ£€æµ‹æ•°å€¼å‡ºç°æ¬¡æ•°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const countOccurrences &#x3D; (arr, val) &#x3D;&gt; arr.reduce((a, v) &#x3D;&gt; (v &#x3D;&#x3D;&#x3D; val ? a + 1 : a), 0);</span><br><span class="line">countOccurrences([1, 1, 2, 1, 2, 3], 1); &#x2F;&#x2F; 3</span><br></pre></td></tr></table></figure>

<h3 id="1-7-å¯»æ‰¾å·®å¼‚"><a href="#1-7-å¯»æ‰¾å·®å¼‚" class="headerlink" title="1.7 å¯»æ‰¾å·®å¼‚"></a>1.7 å¯»æ‰¾å·®å¼‚</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const difference &#x3D; (a, b) &#x3D;&gt; &#123;</span><br><span class="line">  const s &#x3D; new Set(b);</span><br><span class="line">  return a.filter(x &#x3D;&gt; !s.has(x));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">difference([1, 2, 3], [1, 2, 4]); &#x2F;&#x2F; [3]</span><br></pre></td></tr></table></figure>

<h3 id="1-8-è¿”å›æ•°ç»„ä¸­æŸå€¼çš„æ‰€æœ‰ç´¢å¼•"><a href="#1-8-è¿”å›æ•°ç»„ä¸­æŸå€¼çš„æ‰€æœ‰ç´¢å¼•" class="headerlink" title="1.8 è¿”å›æ•°ç»„ä¸­æŸå€¼çš„æ‰€æœ‰ç´¢å¼•"></a>1.8 è¿”å›æ•°ç»„ä¸­æŸå€¼çš„æ‰€æœ‰ç´¢å¼•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#x2F;&#x2F;æ­¤ä»£ç æ®µå¯ç”¨äºè·å–æ•°ç»„ä¸­æŸä¸ªå€¼çš„æ‰€æœ‰ç´¢å¼•ï¼Œå¦‚æœæ­¤å€¼ä¸­æœªåŒ…å«è¯¥å€¼ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚</span><br><span class="line">const indexOfAll &#x3D; (arr, val) &#x3D;&gt; arr.reduce((acc, el, i) &#x3D;&gt; (el &#x3D;&#x3D;&#x3D; val ? [...acc, i] : acc), []);</span><br><span class="line"></span><br><span class="line">indexOfAll([1, 2, 3, 1, 2, 3], 1); &#x2F;&#x2F; [0,3]</span><br><span class="line">indexOfAll([1, 2, 3], 4); &#x2F;&#x2F; []</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96; </span><br><span class="line"></span><br><span class="line">### 1.9 ä¸¤æ•°ç»„çš„äº¤é›†</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>const intersection = (a, b) =&gt; {const s = new Set(b);return a.filter(x =&gt; s.has(x));};</p>
<p>intersection([1, 2, 3], [4, 3, 2]); // [2, 3]</p>
<p>//ä¸¤æ•°ç»„éƒ½ç¬¦åˆæ¡ä»¶çš„äº¤é›†<br>const intersectionBy = (a, b, fn) =&gt; {<br>  const s = new Set(b.map(fn));<br>  return a.filter(x =&gt; s.has(fn(x)));<br>};</p>
<p>intersectionBy([2.1, 1.2], [2.3, 3.4], Math.floor); // [2.1]</p>
<p>//å…ˆæ¯”è¾ƒåè¿”å›äº¤é›†</p>
<p>const intersectionWith = (a, b, comp) =&gt; a.filter(x =&gt; b.findIndex(y =&gt; comp(x, y)) !== -1);</p>
<p>intersectionWith([1, 1.2, 1.5, 3, 0], [1.9, 3, 0, 3.9], (a, b) =&gt; Math.round(a) === Math.round(b)); // [1.5, 3, 0]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 1.10 åœ¨æŒ‡å®šæ•°ç»„ä¸­è·å–éšæœºæ•°</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>const sample = arr =&gt; arr[Math.floor(Math.random() * arr.length)];</p>
<p>sample([3, 7, 9, 11]); // 9</p>
<p>//åœ¨æŒ‡å®šæ•°ç»„ä¸­è·å–æŒ‡å®šé•¿åº¦çš„éšæœºæ•°(Fisher-Yatesç®—æ³•)<br>const sampleSize = ([â€¦arr], n = 1) =&gt; {<br>  let m = arr.length;<br>  while (m) {<br>    const i = Math.floor(Math.random() * mâ€“);<br>    [arr[m], arr[i]] = [arr[i], arr[m]];<br>  }<br>  return arr.slice(0, n);<br>};</p>
<p>sampleSize([1, 2, 3], 2); // [3,1]<br>sampleSize([1, 2, 3], 4); // [2,3,1]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 1.11 éšæœºæ’åºæ•°ç»„çš„å…ƒç´ </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>const shuffle = ([â€¦arr]) =&gt; {<br>  let m = arr.length;<br>  while (m) {<br>    const i = Math.floor(Math.random() * mâ€“);<br>    [arr[m], arr[i]] = [arr[i], arr[m]];<br>  }<br>  return arr;<br>};</p>
<p>const foo = [1, 2, 3];<br>shuffle(foo); // [2, 3, 1], foo = [1, 2, 3]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 1.12 æ ¹æ®&#96;parent_id&#96;ç”Ÿæˆæ ‘ç»“æ„</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>const nest = (items, id = null, link = â€˜parent_idâ€™) =&gt;  items.filter(item =&gt; item[link] === id).map(item =&gt; ({ â€¦item, children: nest(items, item.id) }));</p>
<p>const comments = [<br>  { id: 1, parent_id: null },<br>  { id: 2, parent_id: 1 },<br>  { id: 3, parent_id: 1 },<br>  { id: 4, parent_id: 2 },<br>  { id: 5, parent_id: 4 }<br>];<br>const nestedComments = nest(comments); // [{ id: 1, parent_id: null, children: [â€¦] }]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 2.å‡½æ•°</span><br><span class="line"></span><br><span class="line">### 2.1 æ•è·å‡½æ•°è¿è¡Œå¼‚å¸¸</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>onst attempt = (fn, â€¦args) =&gt; {<br>  try {<br>    return fn(â€¦args);<br>  } catch (e) {<br>    return e instanceof Error ? e : new Error(e);<br>  }<br>};<br>var elements = attempt(function(selector) {<br>  return document.querySelectorAll(selector);<br>}, â€˜&gt;_&gt;â€™);<br>if (elements instanceof Error) elements = []; // elements = []</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 2.2 æ¨è¿Ÿæ‰§è¡Œ</span><br></pre></td></tr></table></figure>
<p>//æ­¤ä»£ç æ®µå»¶è¿Ÿäº†å‡½æ•°çš„æ‰§è¡Œï¼Œç›´åˆ°æ¸…é™¤äº†å½“å‰è°ƒç”¨å †æ ˆã€‚</p>
<p>const defer = (fn, â€¦args) =&gt; setTimeout(fn, 1, â€¦args);</p>
<p>defer(console.log, â€˜aâ€™), console.log(â€˜bâ€™); // logs â€˜bâ€™ then â€˜aâ€™</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 2.3 è¿è¡Œå¤šä¸ª&#96;Promises&#96;</span><br></pre></td></tr></table></figure>
<p>const runPromisesInSeries = ps =&gt; ps.reduce((p, next) =&gt; p.then(next), Promise.resolve());<br>const delay = d =&gt; new Promise(r =&gt; setTimeout(r, d));</p>
<p>runPromisesInSeries([() =&gt; delay(1000), () =&gt; delay(2000)]);<br>//ä¾æ¬¡æ‰§è¡Œæ¯ä¸ªPromises ï¼Œæ€»å…±éœ€è¦3ç§’é’Ÿæ‰èƒ½å®Œæˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 2.4 è®¡ç®—å‡½æ•°æ‰§è¡Œæ—¶é—´</span><br></pre></td></tr></table></figure>
<p>const timeTaken = callback =&gt; {<br>  console.time(â€˜timeTakenâ€™);<br>  const r = callback();<br>  console.timeEnd(â€˜timeTakenâ€™);<br>  return r;<br>};</p>
<p>timeTaken(() =&gt; Math.pow(2, 10)); // 1024, (logged): timeTaken: 0.02099609375ms</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 2.5 ç®€å•çš„å‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å¼</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºä¸€ä¸ªå‘å¸ƒ/è®¢é˜…ï¼ˆå‘å¸ƒ-è®¢é˜…ï¼‰äº‹ä»¶é›†çº¿ï¼Œæœ‰emitï¼Œonå’Œoffæ–¹æ³•ã€‚<br>1.ä½¿ç”¨Object.create(null)åˆ›å»ºä¸€ä¸ªç©ºçš„hubå¯¹è±¡ã€‚<br>2.emitï¼Œæ ¹æ®eventå‚æ•°è§£æå¤„ç†ç¨‹åºæ•°ç»„ï¼Œç„¶å.forEach()é€šè¿‡ä¼ å…¥æ•°æ®ä½œä¸ºå‚æ•°æ¥è¿è¡Œæ¯ä¸ªå¤„ç†ç¨‹åºã€‚<br>3.onï¼Œä¸ºäº‹ä»¶åˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼ˆè‹¥ä¸å­˜åœ¨åˆ™ä¸ºç©ºæ•°ç»„ï¼‰ï¼Œç„¶å.push()å°†å¤„ç†ç¨‹åºæ·»åŠ åˆ°è¯¥æ•°ç»„ã€‚<br>4.offï¼Œç”¨.findIndex()åœ¨äº‹ä»¶æ•°ç»„ä¸­æŸ¥æ‰¾å¤„ç†ç¨‹åºçš„ç´¢å¼•ï¼Œå¹¶ä½¿ç”¨.splice()åˆ é™¤ã€‚</p>
<p>const createEventHub = () =&gt; ({<br>  hub: Object.create(null),<br>  emit(event, data) {<br>    (this.hub[event] || []).forEach(handler =&gt; handler(data));<br>  },<br>  on(event, handler) {<br>    if (!this.hub[event]) this.hub[event] = [];<br>    this.hub[event].push(handler);<br>  },<br>  off(event, handler) {<br>    const i = (this.hub[event] || []).findIndex(h =&gt; h === handler);<br>    if (i &gt; -1) this.hub[event].splice(i, 1);<br>    if (this.hub[event].length === 0) delete this.hub[event];<br>  }<br>});</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ç”¨æ³•ï¼š<br>const handler = data =&gt; console.log(data);<br>const hub = createEventHub();<br>let increment = 0;</p>
<p>// è®¢é˜…ï¼Œç›‘å¬ä¸åŒäº‹ä»¶<br>hub.on(â€˜messageâ€™, handler);<br>hub.on(â€˜messageâ€™, () =&gt; console.log(â€˜Message event firedâ€™));<br>hub.on(â€˜incrementâ€™, () =&gt; increment++);</p>
<p>// å‘å¸ƒï¼šå‘å‡ºäº‹ä»¶ä»¥è°ƒç”¨æ‰€æœ‰è®¢é˜…ç»™å®ƒä»¬çš„å¤„ç†ç¨‹åºï¼Œå¹¶å°†æ•°æ®ä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒä»¬<br>hub.emit(â€˜messageâ€™, â€˜hello worldâ€™); // æ‰“å° â€˜hello worldâ€™ å’Œ â€˜Message event firedâ€™<br>hub.emit(â€˜messageâ€™, { hello: â€˜worldâ€™ }); // æ‰“å° å¯¹è±¡ å’Œ â€˜Message event firedâ€™<br>hub.emit(â€˜incrementâ€™); // increment = 1</p>
<p>// åœæ­¢è®¢é˜…<br>hub.off(â€˜messageâ€™, handler);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">### 2.6 ç¼“å­˜å‡½æ•°</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡å®ä¾‹åŒ–ä¸€ä¸ªMapå¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªç©ºçš„ç¼“å­˜ã€‚<br>é€šè¿‡æ£€æŸ¥è¾“å…¥å€¼çš„å‡½æ•°è¾“å‡ºæ˜¯å¦å·²ç¼“å­˜ï¼Œè¿”å›å­˜å‚¨ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œè¯¥å‚æ•°å°†è¢«æä¾›ç»™å·²è®°å¿†çš„å‡½æ•°ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™å­˜å‚¨å¹¶è¿”å›å®ƒã€‚</p>
<p>const memoize = fn =&gt; {<br>  const cache = new Map();<br>  const cached = function(val) {<br>    return cache.has(val) ? cache.get(val) : cache.set(val, fn.call(this, val)) &amp;&amp; cache.get(val);<br>  };<br>  cached.cache = cache;<br>  return cached;<br>};</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#96;&#96;&#96;</span><br><span class="line">&#x2F;&#x2F;vue æºç ç‰ˆ</span><br><span class="line">&#x2F;**</span><br><span class="line"> * Create a cached version of a pure function. </span><br><span class="line"> *&#x2F;</span><br><span class="line">export function cached&lt;F: Function&gt; (fn: F): F &#123;&#x2F;&#x2F;æ¨æ–­ç±»å‹å‡½æ•°</span><br><span class="line">  const cache &#x3D; Object.create(null)</span><br><span class="line">  return (function cachedFn (str: string) &#123;</span><br><span class="line">    const hit &#x3D; cache[str]</span><br><span class="line">    return hit || (cache[str] &#x3D; fn(str))</span><br><span class="line">  &#125;: any)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-7-åªè°ƒç”¨ä¸€æ¬¡çš„å‡½æ•°"><a href="#2-7-åªè°ƒç”¨ä¸€æ¬¡çš„å‡½æ•°" class="headerlink" title="2.7 åªè°ƒç”¨ä¸€æ¬¡çš„å‡½æ•°"></a>2.7 åªè°ƒç”¨ä¸€æ¬¡çš„å‡½æ•°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const once &#x3D; fn &#x3D;&gt; &#123;</span><br><span class="line">  let called &#x3D; false</span><br><span class="line">  return function () &#123;</span><br><span class="line">    if (!called) &#123;</span><br><span class="line">      called &#x3D; true</span><br><span class="line">      fn.apply(this, arguments)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="2-8-ä»¥é”®çš„è·¯å¾„æ‰å¹³åŒ–å¯¹è±¡"><a href="#2-8-ä»¥é”®çš„è·¯å¾„æ‰å¹³åŒ–å¯¹è±¡" class="headerlink" title="2.8 ä»¥é”®çš„è·¯å¾„æ‰å¹³åŒ–å¯¹è±¡"></a>2.8 ä»¥é”®çš„è·¯å¾„æ‰å¹³åŒ–å¯¹è±¡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨é€’å½’ã€‚</span><br><span class="line">1.åˆ©ç”¨Object.keys(obj)è”åˆArray.prototype.reduce()ï¼Œä»¥æ¯ç‰‡å¶å­èŠ‚ç‚¹è½¬æ¢ä¸ºæ‰å¹³çš„è·¯å¾„èŠ‚ç‚¹ã€‚</span><br><span class="line">2.å¦‚æœé”®çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™å‡½æ•°ä½¿ç”¨è°ƒç”¨é€‚å½“çš„è‡ªèº«prefixä»¥åˆ›å»ºè·¯å¾„Object.assign()ã€‚</span><br><span class="line">3.å¦åˆ™ï¼Œå®ƒå°†é€‚å½“çš„å‰ç¼€é”®å€¼å¯¹æ·»åŠ åˆ°ç´¯åŠ å™¨å¯¹è±¡ã€‚</span><br><span class="line">4.prefixé™¤éæ‚¨å¸Œæœ›æ¯ä¸ªé”®éƒ½æœ‰ä¸€ä¸ªå‰ç¼€ï¼Œå¦åˆ™åº”å§‹ç»ˆçœç•¥ç¬¬äºŒä¸ªå‚æ•°ã€‚</span><br><span class="line"></span><br><span class="line">const flattenObject &#x3D; (obj, prefix &#x3D; &#39;&#39;) &#x3D;&gt;</span><br><span class="line">  Object.keys(obj).reduce((acc, k) &#x3D;&gt; &#123;</span><br><span class="line">    const pre &#x3D; prefix.length ? prefix + &#39;.&#39; : &#39;&#39;;</span><br><span class="line">    if (typeof obj[k] &#x3D;&#x3D;&#x3D; &#39;object&#39;) Object.assign(acc, flattenObject(obj[k], pre + k));</span><br><span class="line">    else acc[pre + k] &#x3D; obj[k];</span><br><span class="line">    return acc;</span><br><span class="line">  &#125;, &#123;&#125;);</span><br><span class="line"></span><br><span class="line">flattenObject(&#123; a: &#123; b: &#123; c: 1 &#125; &#125;, d: 1 &#125;); &#x2F;&#x2F; &#123; &#39;a.b.c&#39;: 1, d: 1 &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ä»¥é”®çš„è·¯å¾„å±•å¼€å¯¹è±¡</span><br><span class="line">const unflattenObject &#x3D; obj &#x3D;&gt;</span><br><span class="line">  Object.keys(obj).reduce((acc, k) &#x3D;&gt; &#123;</span><br><span class="line">    if (k.indexOf(&#39;.&#39;) !&#x3D;&#x3D; -1) &#123;</span><br><span class="line">      const keys &#x3D; k.split(&#39;.&#39;);</span><br><span class="line">      Object.assign(</span><br><span class="line">        acc,</span><br><span class="line">        JSON.parse(</span><br><span class="line">          &#39;&#123;&#39; +</span><br><span class="line">            keys.map((v, i) &#x3D;&gt; (i !&#x3D;&#x3D; keys.length - 1 ? &#96;&quot;$&#123;v&#125;&quot;:&#123;&#96; : &#96;&quot;$&#123;v&#125;&quot;:&#96;)).join(&#39;&#39;) +</span><br><span class="line">            obj[k] +</span><br><span class="line">            &#39;&#125;&#39;.repeat(keys.length)</span><br><span class="line">        )</span><br><span class="line">      );</span><br><span class="line">    &#125; else acc[k] &#x3D; obj[k];</span><br><span class="line">    return acc;</span><br><span class="line">  &#125;, &#123;&#125;);</span><br><span class="line"></span><br><span class="line">unflattenObject(&#123; &#39;a.b.c&#39;: 1, d: 1 &#125;); &#x2F;&#x2F; &#123; a: &#123; b: &#123; c: 1 &#125; &#125;, d: 1 &#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-å­—ç¬¦ä¸²"><a href="#3-å­—ç¬¦ä¸²" class="headerlink" title="3.å­—ç¬¦ä¸²"></a>3.å­—ç¬¦ä¸²</h2><h3 id="3-1-è¿”å›å­—ç¬¦ä¸²çš„å­—èŠ‚é•¿åº¦"><a href="#3-1-è¿”å›å­—ç¬¦ä¸²çš„å­—èŠ‚é•¿åº¦" class="headerlink" title="3.1 è¿”å›å­—ç¬¦ä¸²çš„å­—èŠ‚é•¿åº¦"></a>3.1 è¿”å›å­—ç¬¦ä¸²çš„å­—èŠ‚é•¿åº¦</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const byteSize &#x3D; str &#x3D;&gt; new Blob([str]).size;</span><br><span class="line"></span><br><span class="line">byteSize(&#39;ğŸ˜€&#39;); &#x2F;&#x2F; 4</span><br><span class="line">byteSize(&#39;Hello World&#39;); &#x2F;&#x2F; 11</span><br></pre></td></tr></table></figure>

<h3 id="3-2-é¦–å­—æ¯å¤§å†™å°å†™"><a href="#3-2-é¦–å­—æ¯å¤§å†™å°å†™" class="headerlink" title="3.2 é¦–å­—æ¯å¤§å†™å°å†™"></a>3.2 é¦–å­—æ¯å¤§å†™å°å†™</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const capitalize &#x3D; ([first, ...rest]) &#x3D;&gt; first.toUpperCase() + rest.join(&#39;&#39;);</span><br><span class="line"></span><br><span class="line">capitalize(&#39;fooBar&#39;); &#x2F;&#x2F; &#39;FooBar&#39;</span><br><span class="line">capitalize(&#39;fooBar&#39;, true); &#x2F;&#x2F; &#39;Foobar&#39;</span><br><span class="line"></span><br><span class="line">const decapitalize &#x3D; ([first, ...rest]) &#x3D;&gt; first.toLowerCase() + rest.join(&#39;&#39;)</span><br><span class="line"></span><br><span class="line">decapitalize(&#39;FooBar&#39;); &#x2F;&#x2F; &#39;fooBar&#39;</span><br><span class="line">decapitalize(&#39;FooBar&#39;); &#x2F;&#x2F; &#39;fooBar&#39;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™å°å†™"><a href="#3-3-æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™å°å†™" class="headerlink" title="3.3 æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™å°å†™"></a>3.3 æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™å°å†™</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const capitalizeEveryWord &#x3D; str &#x3D;&gt; str.replace(&#x2F;\b[a-z]&#x2F;g, char &#x3D;&gt; char.toUpperCase());</span><br><span class="line">capitalizeEveryWord(&#39;hello world!&#39;); &#x2F;&#x2F; &#39;Hello World!&#39;</span><br><span class="line"></span><br><span class="line">const capitalizeEveryWord &#x3D; str &#x3D;&gt; str.replace(&#x2F;\b[a-z]&#x2F;g, char &#x3D;&gt; char.toLowerCase());</span><br><span class="line">capitalizeEveryWord(&#39;Hello World!&#39;); &#x2F;&#x2F; &#39;hello world!&#39;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„HTMlæ ‡ç­¾"><a href="#3-4-åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„HTMlæ ‡ç­¾" class="headerlink" title="3.4 åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„HTMlæ ‡ç­¾"></a>3.4 åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„<code>HTMl</code>æ ‡ç­¾</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const stripHTMLTags &#x3D; str &#x3D;&gt; str.replace(&#x2F;&lt;[^&gt;]*&gt;&#x2F;g, &#39;&#39;);</span><br><span class="line"></span><br><span class="line">stripHTMLTags(&#39;&lt;p&gt;&lt;em&gt;lorem&lt;&#x2F;em&gt; &lt;strong&gt;ipsum&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;&#39;); &#x2F;&#x2F; &#39;lorem ipsum&#39;</span><br></pre></td></tr></table></figure>

<h3 id="4-å¯¹è±¡"><a href="#4-å¯¹è±¡" class="headerlink" title="4.å¯¹è±¡"></a>4.å¯¹è±¡</h3><h3 id="4-1-å½“å‰æ—¥æœŸå¤©æ•°"><a href="#4-1-å½“å‰æ—¥æœŸå¤©æ•°" class="headerlink" title="4.1 å½“å‰æ—¥æœŸå¤©æ•°"></a>4.1 å½“å‰æ—¥æœŸå¤©æ•°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const dayOfYear &#x3D; date &#x3D;&gt; Math.floor((date - new Date(date.getFullYear(), 0, 0)) &#x2F; 1000 &#x2F; 60 &#x2F; 60 &#x2F; 24);</span><br><span class="line"></span><br><span class="line">dayOfYear(new Date()); &#x2F;&#x2F; 285</span><br></pre></td></tr></table></figure>

<h3 id="4-2-è¿­ä»£å±æ€§å¹¶æ‰§è¡Œå›è°ƒ"><a href="#4-2-è¿­ä»£å±æ€§å¹¶æ‰§è¡Œå›è°ƒ" class="headerlink" title="4.2 è¿­ä»£å±æ€§å¹¶æ‰§è¡Œå›è°ƒ"></a>4.2 è¿­ä»£å±æ€§å¹¶æ‰§è¡Œå›è°ƒ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const forOwn &#x3D; (obj, fn) &#x3D;&gt; Object.keys(obj).forEach(key &#x3D;&gt; fn(obj[key], key, obj));</span><br><span class="line">forOwn(&#123; foo: &#39;bar&#39;, a: 1 &#125;, v &#x3D;&gt; console.log(v)); &#x2F;&#x2F; &#39;bar&#39;, 1</span><br></pre></td></tr></table></figure>

<h3 id="4-3-è¿”å›å½“å‰24å°æ—¶åˆ¶æ—¶é—´çš„å­—ç¬¦ä¸²"><a href="#4-3-è¿”å›å½“å‰24å°æ—¶åˆ¶æ—¶é—´çš„å­—ç¬¦ä¸²" class="headerlink" title="4.3 è¿”å›å½“å‰24å°æ—¶åˆ¶æ—¶é—´çš„å­—ç¬¦ä¸²"></a>4.3 è¿”å›å½“å‰24å°æ—¶åˆ¶æ—¶é—´çš„å­—ç¬¦ä¸²</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const getColonTimeFromDate &#x3D; date &#x3D;&gt; date.toTimeString().slice(0, 8);</span><br><span class="line"></span><br><span class="line">getColonTimeFromDate(new Date()); &#x2F;&#x2F; &quot;08:38:00&quot;</span><br></pre></td></tr></table></figure>

<h3 id="4-4-è¿”å›æ—¥æœŸé—´çš„å¤©æ•°"><a href="#4-4-è¿”å›æ—¥æœŸé—´çš„å¤©æ•°" class="headerlink" title="4.4 è¿”å›æ—¥æœŸé—´çš„å¤©æ•°"></a>4.4 è¿”å›æ—¥æœŸé—´çš„å¤©æ•°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const getDaysDiffBetweenDates &#x3D; (dateInitial, dateFinal) &#x3D;&gt;  (dateFinal - dateInitial) &#x2F; (1000 * 3600 * 24);</span><br><span class="line"></span><br><span class="line">getDaysDiffBetweenDates(new Date(&#39;2019-01-01&#39;), new Date(&#39;2019-10-14&#39;)); &#x2F;&#x2F; 286</span><br></pre></td></tr></table></figure>

<h3 id="4-5-å…¨ç­‰åˆ¤æ–­"><a href="#4-5-å…¨ç­‰åˆ¤æ–­" class="headerlink" title="4.5 å…¨ç­‰åˆ¤æ–­"></a>4.5 å…¨ç­‰åˆ¤æ–­</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;åœ¨ä¸¤ä¸ªå˜é‡ä¹‹é—´è¿›è¡Œæ·±åº¦æ¯”è¾ƒä»¥ç¡®å®šå®ƒä»¬æ˜¯å¦å…¨ç­‰ã€‚ </span><br><span class="line">&#x2F;&#x2F;æ­¤ä»£ç æ®µç²¾ç®€çš„æ ¸å¿ƒåœ¨äºArray.prototype.every()çš„ä½¿ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">const isAfterDate &#x3D; (dateA, dateB) &#x3D;&gt; dateA &gt; dateB;</span><br><span class="line">const equals &#x3D; (a, b) &#x3D;&gt; &#123;</span><br><span class="line">  if (a &#x3D;&#x3D;&#x3D; b) return true;</span><br><span class="line">  if (a instanceof Date &amp;&amp; b instanceof Date) return a.getTime() &#x3D;&#x3D;&#x3D; b.getTime();</span><br><span class="line">  if (!a || !b || (typeof a !&#x3D;&#x3D; &#39;object&#39; &amp;&amp; typeof b !&#x3D;&#x3D; &#39;object&#39;)) return a &#x3D;&#x3D;&#x3D; b;</span><br><span class="line">  if (a.prototype !&#x3D;&#x3D; b.prototype) return false;</span><br><span class="line">  let keys &#x3D; Object.keys(a);</span><br><span class="line">  if (keys.length !&#x3D;&#x3D; Object.keys(b).length) return false;</span><br><span class="line">  return keys.every(k &#x3D;&gt; equals(a[k], b[k]));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">equals(&#123; a: [2, &#123; e: 3 &#125;], b: [4], c: &#39;foo&#39; &#125;, &#123; a: [2, &#123; e: 3 &#125;], b: [4], c: &#39;foo&#39; &#125;); &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<h2 id="5-æ•°å­—"><a href="#5-æ•°å­—" class="headerlink" title="5.æ•°å­—"></a>5.æ•°å­—</h2><h3 id="5-1-ç”ŸæˆæŒ‡å®šèŒƒå›´çš„éšæœºæ•´æ•°"><a href="#5-1-ç”ŸæˆæŒ‡å®šèŒƒå›´çš„éšæœºæ•´æ•°" class="headerlink" title="5.1 ç”ŸæˆæŒ‡å®šèŒƒå›´çš„éšæœºæ•´æ•°"></a>5.1 ç”ŸæˆæŒ‡å®šèŒƒå›´çš„éšæœºæ•´æ•°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const randomIntegerInRange &#x3D; (min, max) &#x3D;&gt; Math.floor(Math.random() * (max - min + 1)) + min;</span><br><span class="line"></span><br><span class="line">randomIntegerInRange(0, 5); &#x2F;&#x2F; 3</span><br></pre></td></tr></table></figure>

<h3 id="5-2-å››èˆäº”å…¥åˆ°æŒ‡å®šä½æ•°"><a href="#5-2-å››èˆäº”å…¥åˆ°æŒ‡å®šä½æ•°" class="headerlink" title="5.2 å››èˆäº”å…¥åˆ°æŒ‡å®šä½æ•°"></a>5.2 å››èˆäº”å…¥åˆ°æŒ‡å®šä½æ•°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const round &#x3D; (n, decimals &#x3D; 0) &#x3D;&gt; Number(&#96;$&#123;Math.round(&#96;$&#123;n&#125;e$&#123;decimals&#125;&#96;)&#125;e-$&#123;decimals&#125;&#96;);</span><br><span class="line"></span><br><span class="line">round(1.005, 2); &#x2F;&#x2F; 1.01</span><br></pre></td></tr></table></figure>

<h2 id="6-æµè§ˆå™¨æ“ä½œåŠå…¶å®ƒ"><a href="#6-æµè§ˆå™¨æ“ä½œåŠå…¶å®ƒ" class="headerlink" title="6.æµè§ˆå™¨æ“ä½œåŠå…¶å®ƒ"></a>6.æµè§ˆå™¨æ“ä½œåŠå…¶å®ƒ</h2><h3 id="6-1-è¿”å›æŒ‡å®šå…ƒç´ çš„ç”Ÿæ•ˆæ ·å¼"><a href="#6-1-è¿”å›æŒ‡å®šå…ƒç´ çš„ç”Ÿæ•ˆæ ·å¼" class="headerlink" title="6.1 è¿”å›æŒ‡å®šå…ƒç´ çš„ç”Ÿæ•ˆæ ·å¼"></a>6.1 è¿”å›æŒ‡å®šå…ƒç´ çš„ç”Ÿæ•ˆæ ·å¼</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const getStyle &#x3D; (el, ruleName) &#x3D;&gt; getComputedStyle(el)[ruleName];</span><br><span class="line"></span><br><span class="line">getStyle(document.querySelector(&#39;p&#39;), &#39;font-size&#39;); &#x2F;&#x2F; &#39;16px&#39;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-æ£€æŸ¥å½“å‰æ ‡ç­¾é¡µæ˜¯å¦æ´»åŠ¨"><a href="#6-2-æ£€æŸ¥å½“å‰æ ‡ç­¾é¡µæ˜¯å¦æ´»åŠ¨" class="headerlink" title="6.2 æ£€æŸ¥å½“å‰æ ‡ç­¾é¡µæ˜¯å¦æ´»åŠ¨"></a>6.2 æ£€æŸ¥å½“å‰æ ‡ç­¾é¡µæ˜¯å¦æ´»åŠ¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const isBrowserTabFocused &#x3D; () &#x3D;&gt; !document.hidden;</span><br><span class="line"></span><br><span class="line">isBrowserTabFocused(); &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>
<h3 id="6-3-å¹³æ»‘æ»šåŠ¨è‡³é¡¶éƒ¨"><a href="#6-3-å¹³æ»‘æ»šåŠ¨è‡³é¡¶éƒ¨" class="headerlink" title="6.3 å¹³æ»‘æ»šåŠ¨è‡³é¡¶éƒ¨"></a>6.3 å¹³æ»‘æ»šåŠ¨è‡³é¡¶éƒ¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const scrollToTop &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  const c &#x3D; document.documentElement.scrollTop || document.body.scrollTop;</span><br><span class="line">  if (c &gt; 0) &#123;</span><br><span class="line">    window.requestAnimationFrame(scrollToTop);</span><br><span class="line">    window.scrollTo(0, c - c &#x2F; 8);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">scrollToTop();</span><br></pre></td></tr></table></figure>
<h3 id="6-4-æ»šåŠ¨åˆ°æŒ‡å®šå…ƒç´ åŒºåŸŸ"><a href="#6-4-æ»šåŠ¨åˆ°æŒ‡å®šå…ƒç´ åŒºåŸŸ" class="headerlink" title="6.4 æ»šåŠ¨åˆ°æŒ‡å®šå…ƒç´ åŒºåŸŸ"></a>6.4 æ»šåŠ¨åˆ°æŒ‡å®šå…ƒç´ åŒºåŸŸ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const smoothScroll &#x3D; element &#x3D;&gt;</span><br><span class="line">  document.querySelector(element).scrollIntoView(&#123;</span><br><span class="line">    behavior: &#39;smooth&#39;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">smoothScroll(&#39;#fooBar&#39;); </span><br><span class="line">smoothScroll(&#39;.fooBar&#39;); </span><br></pre></td></tr></table></figure>

<h3 id="6-5-æ£€æµ‹ç§»åŠ¨-PCè®¾å¤‡"><a href="#6-5-æ£€æµ‹ç§»åŠ¨-PCè®¾å¤‡" class="headerlink" title="6.5 æ£€æµ‹ç§»åŠ¨/PCè®¾å¤‡"></a>6.5 æ£€æµ‹ç§»åŠ¨/PCè®¾å¤‡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const detectDeviceType &#x3D; () &#x3D;&gt;</span><br><span class="line">  &#x2F;Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini&#x2F;i.test(navigator.userAgent)</span><br><span class="line">    ? &#39;Mobile&#39;</span><br><span class="line">    : &#39;Desktop&#39;;</span><br></pre></td></tr></table></figure>

<h3 id="6-6-escapeHTMLï¼šè½¬ä¹‰HTML-é˜²XSSæ”»å‡»"><a href="#6-6-escapeHTMLï¼šè½¬ä¹‰HTML-é˜²XSSæ”»å‡»" class="headerlink" title="6.6 escapeHTMLï¼šè½¬ä¹‰HTML(é˜²XSSæ”»å‡»)"></a>6.6 <code>escapeHTML</code>ï¼šè½¬ä¹‰<code>HTML</code>(é˜²XSSæ”»å‡»)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const escapeHTML &#x3D; str &#x3D;&gt;</span><br><span class="line">  str.replace(</span><br><span class="line">    &#x2F;[&amp;&lt;&gt;&#39;&quot;]&#x2F;g,</span><br><span class="line">    tag &#x3D;&gt;</span><br><span class="line">      (&#123;</span><br><span class="line">        &#39;&amp;&#39;: &#39;&amp;&#39;,</span><br><span class="line">        &#39;&lt;&#39;: &#39;&lt;&#39;,</span><br><span class="line">        &#39;&gt;&#39;: &#39;&gt;&#39;,</span><br><span class="line">        &quot;&#39;&quot;: &#39;&#39;&#39;,</span><br><span class="line">        &#39;&quot;&#39;: &#39;&quot;&#39;</span><br><span class="line">      &#125;[tag] || tag)</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">escapeHTML(&#39;&lt;a href&#x3D;&quot;#&quot;&gt;Me &amp; you&lt;&#x2F;a&gt;&#39;); &#x2F;&#x2F; &#39;&lt;a href&#x3D;&quot;#&quot;&gt;Me &amp; you&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>










      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syivsy-apep.github.io/2022/05/14/%E6%AF%94%E5%AF%B9%E7%BB%8F%E7%BA%AC%E5%BA%A6%E6%98%AF%E5%90%A6%E5%9C%A8%E8%8C%83%E5%9B%B4%E5%86%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Syivsy-Apep">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/14/%E6%AF%94%E5%AF%B9%E7%BB%8F%E7%BA%AC%E5%BA%A6%E6%98%AF%E5%90%A6%E5%9C%A8%E8%8C%83%E5%9B%B4%E5%86%85/" class="post-title-link" itemprop="url">æ¯”å¯¹ç»çº¬åº¦æ˜¯å¦åœ¨èŒƒå›´å†…</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-05-14 13:09:56" itemprop="dateCreated datePublished" datetime="2022-05-14T13:09:56+08:00">2022-05-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-07-26 11:36:08" itemprop="dateModified" datetime="2022-07-26T11:36:08+08:00">2022-07-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81/" itemprop="url" rel="index"><span itemprop="name">å¸¸ç”¨ä»£ç </span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="æ¯”å¯¹ç»çº¬åº¦æ˜¯å¦åœ¨èŒƒå›´å†…"><a href="#æ¯”å¯¹ç»çº¬åº¦æ˜¯å¦åœ¨èŒƒå›´å†…" class="headerlink" title="æ¯”å¯¹ç»çº¬åº¦æ˜¯å¦åœ¨èŒƒå›´å†…"></a>æ¯”å¯¹ç»çº¬åº¦æ˜¯å¦åœ¨èŒƒå›´å†…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">var isPointInPolygon = <span class="keyword">function</span>(point,pts)&#123;</span><br><span class="line">    var N = pts.length;  //pts [&#123;lat:xxx,lng:xxx&#125;,&#123;lat:xxx,lng:xxx&#125;]</span><br><span class="line">    var boundOrVertex = <span class="literal">true</span>; //å¦‚æœç‚¹ä½äºå¤šè¾¹å½¢çš„é¡¶ç‚¹æˆ–è¾¹ä¸Šï¼Œä¹Ÿç®—åšç‚¹åœ¨å¤šè¾¹å½¢å†…ï¼Œç›´æ¥è¿”å›<span class="literal">true</span></span><br><span class="line">    var intersectCount = 0;</span><br><span class="line">    var precision = 2e-10; //æµ®ç‚¹ç±»å‹è®¡ç®—æ—¶å€™ä¸0æ¯”è¾ƒæ—¶å€™çš„å®¹å·®</span><br><span class="line">    var p1, p2;</span><br><span class="line">    var p = point; //point &#123;lat:xxx,lng:xxx&#125;</span><br><span class="line"> </span><br><span class="line">    p1 = pts[0];//left vertex</span><br><span class="line">    <span class="keyword">for</span>(var i = 1; i &lt;= N; ++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>((p.lat==p1.lat)&amp;&amp;(p.lng==p1.lng))&#123;</span><br><span class="line">           <span class="built_in">return</span> boundOrVertex;</span><br><span class="line">        &#125;</span><br><span class="line">        p2 = pts[i % N];</span><br><span class="line">        <span class="keyword">if</span>(p.lat &lt; Math.min(p1.lat, p2.lat) || p.lat &gt; Math.max(p1.lat, p2.lat))&#123;</span><br><span class="line">           p1 = p2;</span><br><span class="line">           <span class="built_in">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(p.lat &gt; Math.min(p1.lat, p2.lat) &amp;&amp; p.lat &lt; Math.max(p1.lat, p2.lat))&#123;</span><br><span class="line">            <span class="keyword">if</span>(p.lng &lt;= Math.max(p1.lng, p2.lng))&#123;</span><br><span class="line">               <span class="keyword">if</span>(p1.lat == p2.lat &amp;&amp; p.lng &gt;= Math.min(p1.lng, p2.lng))&#123;</span><br><span class="line">                    <span class="built_in">return</span> boundOrVertex;</span><br><span class="line">               &#125;</span><br><span class="line">               <span class="keyword">if</span>(p1.lng == p2.lng)&#123;</span><br><span class="line">                  <span class="keyword">if</span>(p1.lng == p.lng)&#123;</span><br><span class="line">                       <span class="built_in">return</span> boundOrVertex;</span><br><span class="line">                   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                      ++intersectCount;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    var xinters = (p.lat - p1.lat) * (p2.lng - p1.lng) / (p2.lat - p1.lat) + p1.lng;</span><br><span class="line">                    <span class="keyword">if</span>(Math.abs(p.lng - xinters) &lt; precision)&#123;</span><br><span class="line">                        <span class="built_in">return</span> boundOrVertex;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(p.lng &lt; xinters)&#123;</span><br><span class="line">                       ++intersectCount;</span><br><span class="line">                    &#125;</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(p.lat == p2.lat &amp;&amp; p.lng &lt;= p2.lng)&#123;</span><br><span class="line">                var p3 = pts[(i+1) % N];</span><br><span class="line">                <span class="keyword">if</span>(p.lat &gt;= Math.min(p1.lat, p3.lat) &amp;&amp; p.lat &lt;= Math.max(p1.lat, p3.lat))&#123;</span><br><span class="line">                    ++intersectCount;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    intersectCount += 2;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         p1 = p2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intersectCount % 2 == 0)&#123;//å¶æ•°åœ¨å¤šè¾¹å½¢å¤–</span><br><span class="line">       <span class="built_in">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; //å¥‡æ•°åœ¨å¤šè¾¹å½¢å†…</span><br><span class="line">       <span class="built_in">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syivsy-apep.github.io/2022/03/11/ES6%E8%A7%84%E8%8C%83%E6%95%B4%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Syivsy-Apep">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/11/ES6%E8%A7%84%E8%8C%83%E6%95%B4%E7%90%86/" class="post-title-link" itemprop="url">ES6è§„èŒƒæ•´ç†</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-03-11 22:11:03" itemprop="dateCreated datePublished" datetime="2022-03-11T22:11:03+08:00">2022-03-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-03-14 08:47:54" itemprop="dateModified" datetime="2022-03-14T08:47:54+08:00">2022-03-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ES6/" itemprop="url" rel="index"><span itemprop="name">ES6</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ES6-è¯­æ³•éƒ¨åˆ†"><a href="#ES6-è¯­æ³•éƒ¨åˆ†" class="headerlink" title="ES6 è¯­æ³•éƒ¨åˆ†"></a>ES6 è¯­æ³•éƒ¨åˆ†</h1><blockquote>
<ol>
<li>å—ä½œç”¨åŸŸå£°æ˜</li>
</ol>
</blockquote>
<p>JavaScriptä¸­å˜é‡ä½œç”¨åŸŸçš„åŸºæœ¬å•å…ƒä¸€ç›´æ˜¯functionã€‚å¦‚æœéœ€è¦å£°æ˜ä¸€ä¸ªå—ä½œç”¨åŸŸï¼Œæœ€æ™®éçš„åšæ³•é™¤äº†<strong>æ™®é€šçš„å‡½æ•°å£°æ˜å¤–</strong>ï¼Œå°±æ˜¯ç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ï¼ˆIIFEï¼‰ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var a &#x3D; 2;S</span><br><span class="line">(function IIFE()&#123;</span><br><span class="line">  var a &#x3D; 3;</span><br><span class="line">  console.log(a); &#x2F;&#x2F;3</span><br><span class="line"> &#125;)();</span><br><span class="line">console.log(a) &#x2F;&#x2F; 2;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>1.1 let å£°æ˜</p>
</blockquote>
<p>ä½¿ç”¨<strong>let</strong> åªéœ€è¦ä¸€å¯¹{â€¦} å°±å¯ä»¥åˆ›å»ºç»‘å®šåˆ°ä»»ä½•å—çš„å£°æ˜ã€‚ä¸åƒ<strong>var</strong>é‚£æ ·å£°æ˜çš„å˜é‡æ€»æ•°å½’å±äºåŒ…å«å‡½æ•°ï¼ˆå³å…¨å±€ï¼Œå¦‚æœåœ¨æœ€é¡¶å±‚çš„è¯ï¼‰ä½œç”¨åŸŸã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var a &#x3D; 2;</span><br><span class="line">&#123;</span><br><span class="line">  let a &#x3D; 3;</span><br><span class="line">  console.log(a); &#x2F;&#x2F;3</span><br><span class="line">&#125;</span><br><span class="line">console.log(a);&#x2F;&#x2F;2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>1.2 const å£°æ˜</p>
</blockquote>
<p><strong>const</strong> ï¼Œç”¨äºåˆ›å»ºå¸¸é‡ã€‚å¸¸é‡çš„å€¼åœ¨å£°æ˜æ—¶è®¾å®šä¹‹åå°±ä¸å…è®¸æ”¹å˜äº†ã€‚<strong>const</strong> å£°æ˜å¿…é¡»è¦æœ‰æ˜¾å¼çš„åˆå§‹åŒ–ã€‚<br>å¸¸é‡å¹¶ä¸æ˜¯å¯¹ä¸€ä¸ªå€¼æœ¬èº«çš„é™åˆ¶ï¼Œè€Œæ˜¯å¯¹èµ‹å€¼çš„é‚£ä¸ªå˜é‡çš„é™åˆ¶ã€‚æ¢å¥è¯æ˜¯ï¼Œè¿™ä¸ªå€¼å¹¶æ²¡æœ‰å› ä¸º<strong>const</strong>è¢«é”å®šæˆ–è€…ä¸å¯å˜ï¼Œåªæ˜¯èµ‹å€¼æœ¬èº«ä¸å¯å˜ã€‚å¦‚æœè¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªå¤æ‚å€¼ï¼Œæ¯”å¦‚å¯¹è±¡æˆ–æ•°ç»„ï¼Œå…¶å†…å®¹ä¾ç„¶æ˜¯å¯ä»¥æ”¹å˜çš„ã€‚ä¾‹å¦‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  const a &#x3D; [1,2,3]</span><br><span class="line">  a.push(4);</span><br><span class="line">  console.log(a); &#x2F;&#x2F; [1,2,3,4]</span><br><span class="line">  a &#x3D; 42; &#x2F;&#x2F;typeError;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>1.3 å—çº§ä½œç”¨åŸŸå‡½æ•°</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  foo(); &#x2F;&#x2F;è°ƒç”¨æˆåŠŸ</span><br><span class="line">  function foo()&#123;</span><br><span class="line">    &#x2F;&#x2F;...</span><br><span class="line">  &#125;</span><br><span class="line">  foo(); &#x2F;&#x2F;ReferenceError</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>foo()å‡½æ•°å£°æ˜åœ¨{â€¦}å—å†…ã€‚ES6æ”¯æŒå—ä½œç”¨åŸŸï¼Œæ‰€ä»¥åœ¨å—å¤–ä¸å¯ç”¨ã€‚ä½†æ˜¯è¿˜æ˜¯è¦æ³¨æ„å®ƒåœ¨å—å†…æå‡äº†ï¼Œä¸<strong>let</strong>å£°æ˜ä¸åŒã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syivsy-apep.github.io/2022/02/10/%E6%90%9E%E6%87%82extend%E5%92%8C$mount%E5%8E%9F%E7%90%86%E5%B9%B6%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%91%BD%E4%BB%A4%E5%BC%8FConfirm%E5%BC%B9%E7%AA%97%E7%BB%84%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Syivsy-Apep">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/10/%E6%90%9E%E6%87%82extend%E5%92%8C$mount%E5%8E%9F%E7%90%86%E5%B9%B6%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%91%BD%E4%BB%A4%E5%BC%8FConfirm%E5%BC%B9%E7%AA%97%E7%BB%84%E4%BB%B6/" class="post-title-link" itemprop="url">ææ‡‚extendå’Œ$mountåŸç†å¹¶å®ç°ä¸€ä¸ªå‘½ä»¤å¼Confirmå¼¹çª—ç»„ä»¶</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-02-10 09:33:30" itemprop="dateCreated datePublished" datetime="2022-02-10T09:33:30+08:00">2022-02-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-03-11 22:09:58" itemprop="dateModified" datetime="2022-03-11T22:09:58+08:00">2022-03-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="åŸç†è§£æä¹‹extendå’Œ-mount"><a href="#åŸç†è§£æä¹‹extendå’Œ-mount" class="headerlink" title="åŸç†è§£æä¹‹extendå’Œ$mount"></a>åŸç†è§£æä¹‹extendå’Œ$mount</h1><p>è¿™ä¸¤ä¸ªéƒ½æ˜¯<code>vue</code>æä¾›çš„<code>API</code>ï¼Œåœ¨<code>vue</code>çš„å†…éƒ¨ä¹Ÿæœ‰ä½¿ç”¨è¿‡è¿™ä¸€å¯¹<code>API</code>ã€‚é‡åˆ°åµŒå¥—ç»„ä»¶æ—¶ï¼Œé¦–å…ˆå°†å­ç»„ä»¶è½¬ä¸ºç»„ä»¶å½¢å¼çš„<code>VNode</code>æ—¶ï¼Œä¼šå°†å¼•å…¥çš„ç»„ä»¶å¯¹è±¡ä½¿ç”¨extendè½¬ä¸ºå­ç»„ä»¶çš„æ„é€ å‡½æ•°ï¼Œä½œä¸º<code>VNode</code>çš„ä¸€ä¸ªå±æ€§<code>Ctor</code>ï¼›ç„¶ååœ¨å°†<code>VNode</code>è½¬ä¸ºçœŸå®çš„<code>Dom</code>çš„æ—¶å€™å®ä¾‹åŒ–è¿™ä¸ªæ„é€ å‡½æ•°ï¼›æœ€åå®ä¾‹åŒ–å®Œæˆåæ‰‹åŠ¨è°ƒç”¨<code>$mount</code>è¿›è¡ŒæŒ‚è½½ï¼Œå°†çœŸå®<code>Dom</code>æ’å…¥åˆ°çˆ¶èŠ‚ç‚¹å†…å®Œæˆæ¸²æŸ“ã€‚</p>
<p>å³ï¼š<br>æˆ‘ä»¬è‡ªå·±å¯¹ç»„ä»¶å¯¹è±¡ä½¿ç”¨<code>extend</code>è½¬ä¸ºæ„é€ å‡½æ•°ï¼Œç„¶åæ‰‹åŠ¨è°ƒç”¨<code>$mount</code>è½¬ä¸ºçœŸå®<code>Dom</code>ï¼Œç”±æˆ‘ä»¬æ¥æŒ‡å®šä¸€ä¸ªçˆ¶èŠ‚ç‚¹è®©å®ƒæ’å…¥åˆ°æŒ‡å®šçš„ä½ç½®ã€‚</p>
<h2 id="extend"><a href="#extend" class="headerlink" title="extend"></a>extend</h2><p>æ¥å—çš„æ˜¯ä¸€ä¸ªç»„ä»¶å¯¹è±¡ï¼Œå†æ‰§è¡Œ<code>extend</code>æ—¶å°†ç»§æ‰¿åŸºç±»æ„é€ å™¨ä¸Šçš„ä¸€äº›å±æ€§ã€åŸå‹æ–¹æ³•ã€é™æ€æ–¹æ³•ç­‰ï¼Œæœ€åè¿”å›<code>Sub</code>è¿™ä¹ˆä¸€ä¸ªæ„é€ å¥½çš„å­ç»„ä»¶æ„é€ å‡½æ•°ã€‚æ‹¥æœ‰å’Œ<code>vue</code>åŸºç±»ä¸€æ ·çš„èƒ½åŠ›ï¼Œå¹¶åœ¨å®ä¾‹åŒ–æ—¶ä¼šæ‰§è¡Œç»§æ‰¿æ¥çš„<code>_init</code>æ–¹æ³•å®Œæˆå­ç»„ä»¶çš„åˆå§‹åŒ–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">Vue.extend &#x3D; fuction(extendOption&#x3D;&#123;&#125;) &#x3D;&gt; &#123;</span><br><span class="line">  const Super &#x3D; this &#x2F;&#x2F;Vueçš„åŸºæœ¬æ„é€ å‡½æ•°</span><br><span class="line">  const name &#x3D; extendOption.name || Super.options.name</span><br><span class="line"></span><br><span class="line">  const Sub &#x3D; fuction (option) &#x3D; &#123;&#x2F;&#x2F;å®šä¹‰æ„é€ å‡½æ•°</span><br><span class="line">    this._init(option); &#x2F;&#x2F;_initç»§æ‰¿è€Œæ¥</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  Sub.prototype &#x3D; Object.create(Super.prototype) &#x2F;&#x2F;ç»§æ‰¿åŸºæœ¬Vueåˆå§‹åŒ–å®šä¹‰çš„åŸå‹æ–¹æ³•</span><br><span class="line">  Sub.prototype.constructor &#x3D; Sub; &#x2F;&#x2F;æ„é€ å‡½æ•°æŒ‡å‘å­ç±»</span><br><span class="line">  Sub.options &#x3D; mergeOptions( &#x2F;&#x2F;å­ç±»åˆå¹¶options</span><br><span class="line">    Super.options, &#x2F;&#x2F; components, directives, filters, _base</span><br><span class="line">    extendOption &#x2F;&#x2F; ä¼ å…¥çš„ç»„ä»¶å¯¹è±¡</span><br><span class="line">  )</span><br><span class="line">  Sub[&#39;super&#39;] &#x3D; Super &#x2F;&#x2F; VueåŸºç±»</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; å°†åŸºç±»çš„é™æ€æ–¹æ³•èµ‹å€¼ç»™å­ç±»</span><br><span class="line">  Sub.extend &#x3D; Super.extend</span><br><span class="line">  Sub.mixin &#x3D; Super.mixin</span><br><span class="line">  Sub.use &#x3D; Super.use</span><br><span class="line"></span><br><span class="line">  ASSET_TYPES.forEach(function (type) &#123; &#x2F;&#x2F; [&#39;component&#39;, &#39;directive&#39;, &#39;filter&#39;]</span><br><span class="line">    Sub[type] &#x3D; Super[type]</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  if (name) &#123;  è®©ç»„ä»¶å¯ä»¥é€’å½’è°ƒç”¨è‡ªå·±ï¼Œæ‰€ä»¥ä¸€å®šè¦å®šä¹‰nameå±æ€§</span><br><span class="line">    Sub.options.components[name] &#x3D; Sub  &#x2F;&#x2F; å°†å­ç±»æŒ‚è½½åˆ°è‡ªå·±çš„componentså±æ€§ä¸‹</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Sub.superOptions &#x3D; Super.options</span><br><span class="line">  Sub.extendOptions &#x3D; extendOptions</span><br><span class="line"></span><br><span class="line">  return Sub  &#x2F;&#x2F; è¿”å›å­ç»„ä»¶çš„æ„é€ å‡½æ•°</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å®ä¾‹åŒ–Sub"><a href="#å®ä¾‹åŒ–Sub" class="headerlink" title="å®ä¾‹åŒ–Sub"></a>å®ä¾‹åŒ–Sub</h2><p>æ‰§è¡Œ<code>_init</code>ç»„ä»¶åˆå§‹åŒ–çš„ä¸€ç³»åˆ—æ“ä½œï¼Œåˆå§‹åŒ–äº‹ä»¶ã€ç”Ÿå‘½å‘¨æœŸã€çŠ¶æ€ç­‰ç­‰ã€‚å°†<code>data</code>æˆ–<code>props</code>å†…å®šä¹‰çš„å˜é‡æŒ‚è½½åˆ°å½“å‰<code>this</code>å®ä¾‹ä¸‹ï¼Œæœ€åè¿”å›ä¸€ä¸ªå®ä¾‹åŒ–åçš„å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype._init &#x3D; function(options) &#123;  &#x2F;&#x2F; åˆå§‹åŒ–</span><br><span class="line">  ...</span><br><span class="line">  initLifecycle(vm)</span><br><span class="line">  initEvents(vm)</span><br><span class="line">  initRender(vm)</span><br><span class="line">  callHook(vm, &#39;beforeCreate&#39;)</span><br><span class="line">  initInjections(vm)</span><br><span class="line">  initState(vm)</span><br><span class="line">  initProvide(vm)</span><br><span class="line">  callHook(vm, &#39;created&#39;)  &#x2F;&#x2F; åˆå§‹åŒ–é˜¶æ®µå®Œæˆ</span><br><span class="line">  ...</span><br><span class="line">  </span><br><span class="line">  if (vm.$options.el) &#123;  &#x2F;&#x2F; å¼€å§‹æŒ‚è½½é˜¶æ®µ</span><br><span class="line">    vm.$mount(vm.$options.el)  &#x2F;&#x2F; æ‰§è¡ŒæŒ‚è½½</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syivsy-apep.github.io/2022/01/07/useEffect/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Syivsy-Apep">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/07/useEffect/" class="post-title-link" itemprop="url">useEffect</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-01-07 14:26:41" itemprop="dateCreated datePublished" datetime="2022-01-07T14:26:41+08:00">2022-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-02-10 09:12:09" itemprop="dateModified" datetime="2022-02-10T09:12:09+08:00">2022-02-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„-Props-and-State"><a href="#æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„-Props-and-State" class="headerlink" title="æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„ Props and State"></a>æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„ Props and State</h2><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè®¡æ•°å™¨ç»„ä»¶Counter:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function Counter()&#123;</span><br><span class="line">  const [count, setCount] &#x3D; useState(0);</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;You clicked &#123;count&#125; times&lt;&#x2F;p&gt;</span><br><span class="line">      &lt;button onClick&#x3D;&#123;() &#x3D;&gt; setCount(count + 1)&#125;&gt;</span><br><span class="line">        Click me</span><br><span class="line">      &lt;&#x2F;button&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çš„ç»„ä»¶ç¬¬ä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼Œä»useState()æ‹¿åˆ°countçš„åˆå§‹å€¼0ã€‚å½“æˆ‘ä»¬è°ƒç”¨setCount(1)ï¼ŒReactä¼šå†æ¬¡æ¸²æŸ“ç»„ä»¶ï¼Œè¿™ä¸€æ¬¡countæ˜¯1ã€‚å¦‚æ­¤ç­‰ç­‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;ç¬¬ä¸€æ¬¡æ¸²æŸ“</span><br><span class="line">function Counter() &#123;</span><br><span class="line">  const count &#x3D; 0; &#x2F;&#x2F; Returned by useState()</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">  &lt;p&gt;You clicked &#123;count&#125; times&lt;&#x2F;p&gt;</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ç‚¹å‡»å æ–¹æ³•é‡æ–°å“åº”</span><br><span class="line">function Counter() &#123;</span><br><span class="line">  const count &#x3D; 1; &#x2F;&#x2F; Returned by useState()</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">  &lt;p&gt;You clicked &#123;count&#125; times&lt;&#x2F;p&gt;</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; å†ç‚¹å‡» æ–¹æ³•å†é‡æ–°å“åº”</span><br><span class="line">function Counter() &#123;</span><br><span class="line">  const count &#x3D; 2; &#x2F;&#x2F; Returned by useState()</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">  &lt;p&gt;You clicked &#123;count&#125; times&lt;&#x2F;p&gt;</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>å½“æˆ‘ä»¬æ›´æ–°çŠ¶æ€çš„æ—¶å€™ï¼ŒReactä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½èƒ½æ‹¿åˆ°ç‹¬ç«‹çš„count çŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€å€¼æ˜¯å‡½æ•°ä¸­çš„ä¸€ä¸ª<strong>å¸¸é‡</strong>ã€‚</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ‰€ä»¥ä¸‹é¢çš„è¿™è¡Œä»£ç æ²¡æœ‰åšä»»ä½•ç‰¹æ®Šçš„æ•°æ®ç»‘å®šï¼š</span><br><span class="line">&lt;p&gt;You clicked &#123;count&#125; times&lt;&#x2F;p&gt;</span><br></pre></td></tr></table></figure>

<p><strong>å®ƒä»…ä»…åªæ˜¯åœ¨æ¸²æŸ“è¾“å‡ºä¸­æ’å…¥äº†countè¿™ä¸ªæ•°å­—ã€‚</strong> è¿™ä¸ªæ•°å­—ç”±Reactæä¾›ã€‚å½“setCountçš„æ—¶å€™ï¼ŒReactä¼šå¸¦ç€ä¸€ä¸ªä¸åŒçš„countå€¼å†æ¬¡è°ƒç”¨ç»„ä»¶ã€‚ç„¶åï¼ŒReactä¼šæ›´æ–°DOMä»¥ä¿æŒå’Œæ¸²æŸ“è¾“å‡ºä¸€è‡´ã€‚</p>
<p>è¿™é‡Œå…³é”®çš„ç‚¹åœ¨äºä»»æ„ä¸€æ¬¡æ¸²æŸ“ä¸­çš„countå¸¸é‡éƒ½ä¸ä¼šéšç€æ—¶é—´æ”¹å˜ã€‚æ¸²æŸ“è¾“å‡ºä¼šå˜æ˜¯å› ä¸ºæˆ‘ä»¬çš„ç»„ä»¶è¢«ä¸€æ¬¡æ¬¡è°ƒç”¨ï¼Œè€Œæ¯ä¸€æ¬¡è°ƒç”¨å¼•èµ·çš„æ¸²æŸ“ä¸­ï¼Œå®ƒåŒ…å«çš„countå€¼ç‹¬ç«‹äºå…¶ä»–æ¸²æŸ“ã€‚</p>
<h2 id="æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„äº‹ä»¶å¤„ç†å‡½æ•°"><a href="#æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„äº‹ä»¶å¤„ç†å‡½æ•°" class="headerlink" title="æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„äº‹ä»¶å¤„ç†å‡½æ•°"></a>æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„äº‹ä»¶å¤„ç†å‡½æ•°</h2><p>çœ‹ä¸‹é¢çš„è¿™ä¸ªä¾‹å­ã€‚å®ƒåœ¨ä¸‰ç§’åä¼šalertç‚¹å‡»æ¬¡æ•°countï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">function Counter() &#123;</span><br><span class="line">  const [count, setCount] &#x3D; useState(0);</span><br><span class="line"></span><br><span class="line">  function handleAlertClick() &#123;</span><br><span class="line">    setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line">      alert(&#39;You clicked on: &#39; + count);</span><br><span class="line">    &#125;, 3000);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;You clicked &#123;count&#125; times&lt;&#x2F;p&gt;</span><br><span class="line">      &lt;button onClick&#x3D;&#123;() &#x3D;&gt; setCount(count + 1)&#125;&gt;</span><br><span class="line">        Click me</span><br><span class="line">      &lt;&#x2F;button&gt;</span><br><span class="line">      &lt;button onClick&#x3D;&#123;handleAlertClick&#125;&gt;</span><br><span class="line">        Show alert</span><br><span class="line">      &lt;&#x2F;button&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤å»æ“ä½œï¼š</p>
<ul>
<li>ç‚¹å‡»å¢åŠ counteråˆ°3</li>
<li>ç‚¹å‡»ä¸€ä¸‹ â€œShow alertâ€</li>
<li>ç‚¹å‡»å¢åŠ  counteråˆ°5å¹¶ä¸”åœ¨å®šæ—¶å™¨å›è°ƒè§¦å‘å‰å®Œæˆ</li>
</ul>
<p>ç­”æ¡ˆæ˜¯3ï¼ˆalertä¼šâ€œæ•è·â€æˆ‘ç‚¹å‡»æŒ‰é’®æ—¶å€™çš„çŠ¶æ€ã€‚ï¼‰</p>
<p>æˆ‘ä»¬å‘ç°countåœ¨æ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨ä¸­éƒ½æ˜¯ä¸€ä¸ªå¸¸é‡å€¼ã€‚å€¼å¾—å¼ºè°ƒçš„æ˜¯ â€” æˆ‘ä»¬çš„ç»„ä»¶å‡½æ•°æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šè¢«è°ƒç”¨ï¼Œä½†æ˜¯æ¯ä¸€æ¬¡è°ƒç”¨ä¸­countå€¼éƒ½æ˜¯å¸¸é‡ï¼Œå¹¶ä¸”å®ƒè¢«èµ‹äºˆäº†å½“å‰æ¸²æŸ“ä¸­çš„çŠ¶æ€å€¼ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syivsy-apep.github.io/2022/01/07/get%E8%AF%B7%E6%B1%82%E4%B8%AD%E6%96%87%E5%8F%82%E6%95%B0%E4%B9%B1%E7%A0%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Syivsy-Apep">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/07/get%E8%AF%B7%E6%B1%82%E4%B8%AD%E6%96%87%E5%8F%82%E6%95%B0%E4%B9%B1%E7%A0%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">getè¯·æ±‚ä¸­æ–‡å‚æ•°ä¹±ç è§£å†³æ–¹æ³•</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-01-07 11:40:16 / ä¿®æ”¹æ—¶é—´ï¼š11:46:24" itemprop="dateCreated datePublished" datetime="2022-01-07T11:40:16+08:00">2022-01-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/" itemprop="url" rel="index"><span itemprop="name">å‰ç«¯é—®é¢˜è§£å†³</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>æµè§ˆå™¨å‘è¯·æ±‚ï¼Œé»˜è®¤å‘çš„æ˜¯getè¯·æ±‚ï¼Œç„¶åå¸¦å‚æ•°ï¼Œå‚æ•°åŒ…å«ä¸­æ–‡æ±‰å­—ã€‚å‚æ•°é‡Œé¢çš„æ±‰å­—ï¼Œåœ¨æ¥æ”¶çš„æ—¶å€™ï¼Œæ˜¯ä¹±ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function getParam(name) &#123;</span><br><span class="line">     var reg &#x3D; new RegExp(&quot;(^|&amp;)&quot; + name + &quot;&#x3D;([^&amp;]*)(&amp;|$)&quot;);</span><br><span class="line">     var r &#x3D; window.location.search.substr(1).match(reg);</span><br><span class="line">      if (r !&#x3D; null) return decodeURI(r[2]);   &#x2F;&#x2F;å¯¹å‚æ•°è¿›è¡ŒdecodeURIè§£ç </span><br><span class="line">      return null;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syivsy-apep.github.io/2022/01/04/React%E8%99%9A%E6%8B%9FDOM%E7%9A%84Diff%E5%8E%9F%E7%90%86%E5%85%A8%E8%A7%A3%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Syivsy-Apep">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/04/React%E8%99%9A%E6%8B%9FDOM%E7%9A%84Diff%E5%8E%9F%E7%90%86%E5%85%A8%E8%A7%A3%E6%9E%90/" class="post-title-link" itemprop="url">Reactè™šæ‹ŸDOMçš„DiffåŸç†å…¨è§£æ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-01-04 17:16:11" itemprop="dateCreated datePublished" datetime="2022-01-04T17:16:11+08:00">2022-01-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-01-05 09:47:00" itemprop="dateModified" datetime="2022-01-05T09:47:00+08:00">2022-01-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Reactè™šæ‹ŸDOMçš„DiffåŸç†å…¨è§£æ"><a href="#Reactè™šæ‹ŸDOMçš„DiffåŸç†å…¨è§£æ" class="headerlink" title="Reactè™šæ‹ŸDOMçš„DiffåŸç†å…¨è§£æ"></a>Reactè™šæ‹ŸDOMçš„DiffåŸç†å…¨è§£æ</h1><p>æ€ç»´å›¾ï¼š</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/19/16de41554a3ff3e2~tplv-t2oaga2asx-watermark.awebp" alt="Alt"></p>
<h2 id="è®¾è®¡æ€æƒ³"><a href="#è®¾è®¡æ€æƒ³" class="headerlink" title="è®¾è®¡æ€æƒ³"></a>è®¾è®¡æ€æƒ³</h2><ol>
<li>æ°¸è¿œåªæ¯”è¾ƒåŒå±‚èŠ‚ç‚¹ï¼Œä¸ä¼šè·¨å±‚çº§æ¯”è¾ƒèŠ‚ç‚¹ã€‚</li>
<li>ä¸åŒçš„ä¸¤ä¸ªèŠ‚ç‚¹äº§ç”Ÿä¸åŒçš„æ ‘ã€‚æŠŠåŸæ¥çš„èŠ‚ç‚¹ä»¥åŠå®ƒçš„åä»£å…¨éƒ¨å¹²æ‰ï¼Œæ›¿æ¢æˆæ–°çš„</li>
<li>é€šè¿‡keyå€¼æŒ‡å®šå“ªäº›å…ƒç´ æ˜¯ç›¸åŒçš„</li>
</ol>
<h2 id="æ‰§è¡Œè§„åˆ™"><a href="#æ‰§è¡Œè§„åˆ™" class="headerlink" title="æ‰§è¡Œè§„åˆ™"></a>æ‰§è¡Œè§„åˆ™</h2><ol>
<li>å…ƒç´ ç±»å‹ä¸ç›¸åŒæ—¶</li>
</ol>
<p>æ‹†å¸ä»¥è¯¥èŠ‚ç‚¹ä¸ºæ ¹çš„æ ‘å¹¶å»ºç«‹èµ·æ–°çš„æ ‘</p>
<ol start="2">
<li>å…ƒç´ ç±»å‹ç›¸åŒæ—¶</li>
</ol>
<ul>
<li><p>éƒ½æ˜¯DOMèŠ‚ç‚¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div className&#x3D;&quot;old&quot; title&#x3D;&quot;è€èŠ‚ç‚¹&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">&lt;div className&#x3D;&quot;new&quot; title&#x3D;&quot;æ–°èŠ‚ç‚¹&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡æ¯”å¯¹è¿™ä¸¤ä¸ªå…ƒç´ ï¼ŒReact çŸ¥é“éœ€è¦ä¿®æ”¹ DOM å…ƒç´ ä¸Šçš„ className å±æ€§å’Œ title å±æ€§ã€‚å¤„ç†å®Œè¯¥èŠ‚ç‚¹åï¼ŒReact ç»§ç»­å¯¹å­èŠ‚ç‚¹è¿›è¡Œé€’å½’ã€‚</p>
</li>
<li><p>éƒ½æ˜¯ç»„ä»¶å…ƒç´ </p>
</li>
</ul>
<p>ç»„ä»¶å®ä¾‹ä¿æŒä¸å˜ï¼Œæ›´æ–° propsã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™æ—¶å€™è°ƒç”¨ç»„ä»¶å®ä¾‹çš„ componentWillReceiveProps () æ–¹æ³•ã€‚ç„¶åé€šè¿‡ shouldComponentUpdate è¿”å›å€¼å†³å®šæ˜¯å¦è°ƒç”¨ render æ–¹æ³•ã€‚<br>å¤„ç†å®Œè¯¥èŠ‚ç‚¹åï¼Œä¾ç„¶ç»§ç»­å¯¹å­èŠ‚ç‚¹è¿›è¡Œé€’å½’ã€‚</p>
<ul>
<li>ç‰¹æ®Šæƒ…å†µï¼šéå†å­å…ƒç´ åˆ—è¡¨<br>é¦–å…ˆå¾€åˆ—è¡¨æœ«å°¾æ’å…¥ä¸€ä¸ªå…ƒç´ :<br>å¼•å…¥ key å€¼<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;li&gt;1&lt;&#x2F;li&gt;</span><br><span class="line">  &lt;li&gt;2&lt;&#x2F;li&gt;</span><br><span class="line">&lt;&#x2F;ul&gt;</span><br><span class="line">&#x2F;&#x2F;æ’å…¥åä¸º:</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;li&gt;1&lt;&#x2F;li&gt;</span><br><span class="line">  &lt;li&gt;2&lt;&#x2F;li&gt;</span><br><span class="line">  &lt;li&gt;3&lt;&#x2F;li&gt;</span><br><span class="line">&lt;&#x2F;ul&gt;</span><br><span class="line">&#x2F;&#x2F;React ä¼šå…ˆåŒ¹é…ä¸¤ä¸ªå¯¹åº”çš„æ ‘ï¼Œæœ€åæ’å…¥ç¬¬ä¸‰ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚</span><br><span class="line">&#x2F;&#x2F;ä½†æ˜¯å¦‚æœåœ¨å¤´éƒ¨æ’å…¥å‘¢ï¼Ÿ</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;li&gt;3&lt;&#x2F;li&gt;</span><br><span class="line">  &lt;li&gt;1&lt;&#x2F;li&gt;</span><br><span class="line">  &lt;li&gt;2&lt;&#x2F;li&gt;</span><br><span class="line">&lt;&#x2F;ul&gt;</span><br><span class="line">&#x2F;&#x2F;æ­¤æ—¶å‰ä¸¤ä¸ªå…ƒç´ å’ŒåŸæ¥éƒ½ä¸ä¸€æ ·ï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ è¢«å½“ä½œæ–°å¢çš„èŠ‚ç‚¹ï¼Œæ˜æ˜åªéœ€è¦æ›´æ–° 1 ä¸ªèŠ‚ç‚¹ï¼Œç°åœ¨æ›´æ–°äº† 3 ä¸ªã€‚è¿™æ ·çš„æƒ…å†µæ•ˆç‡æ˜¯éå¸¸ä½çš„ã€‚</span><br><span class="line">&#x2F;&#x2F;äºæ˜¯ï¼ŒReact å¼•å…¥äº† key å€¼çš„æ¦‚å¿µã€‚</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;li key&#x3D;&quot;first&quot;&gt;1&lt;&#x2F;li&gt;</span><br><span class="line">  &lt;li key&#x3D;&quot;second&quot;&gt;2&lt;&#x2F;li&gt;</span><br><span class="line">&lt;&#x2F;ul&gt;</span><br><span class="line">æ’å…¥ä¹‹åå˜ä¸º:</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;li key&#x3D;&quot;third&quot;&gt;3&lt;&#x2F;li&gt;</span><br><span class="line">  &lt;li key&#x3D;&quot;first&quot;&gt;1&lt;&#x2F;li&gt;</span><br><span class="line">  &lt;li key&#x3D;&quot;second&quot;&gt;2&lt;&#x2F;li&gt;</span><br><span class="line">&lt;&#x2F;ul&gt;</span><br></pre></td></tr></table></figure>
ç°åœ¨ React é€šè¿‡ key å¾—çŸ¥ 1 å’Œ 2 åŸæ¥æ˜¯å­˜åœ¨çš„ï¼Œç°åœ¨åªæ˜¯æ¢äº†ä½ç½®ï¼Œå› æ­¤ä¸éœ€è¦æ›´æ–°æ•´ä¸ªèŠ‚ç‚¹äº†ï¼Œåªéœ€è¦ç§»åŠ¨ä½ç½®å³å¯ï¼Œå¤§å¤§æå‡æ•ˆç‡ã€‚</li>
</ul>
<p>é€‰å– key å€¼çš„é—®é¢˜<br>key é€‰å–çš„åŸä¸€èˆ¬æ˜¯ <strong>ä¸éœ€è¦å…¨å±€å”¯ä¸€ï¼Œä½†å¿…é¡»åˆ—è¡¨ä¸­ä¿æŒå”¯ä¸€</strong>ã€‚</p>
<p>ç”¨æ•°ç»„å…ƒç´ çš„ä¸‹æ ‡ä½œä¸º key å€¼ï¼Œåœ¨å…ƒç´ é¡ºåºä¸æ”¹å˜çš„æƒ…å†µæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†ä¸€æ—¦é¡ºåºå‘ç”Ÿæ”¹å˜ï¼Œdiff æ•ˆç‡å°±æœ‰å¯èƒ½éª¤ç„¶ä¸‹é™ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å› æ­¤ï¼Œä¸ç”¨æ•°ç»„ç´¢å¼•åš key å€¼çš„æ ¹æœ¬åŸå› åœ¨äºï¼šæ•°ç»„ä¸‹æ ‡å€¼ä¸ç¨³å®šï¼Œä¿®æ”¹é¡ºåºä¼šä¿®æ”¹å½“å‰ key</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syivsy-apep.github.io/2021/12/09/Promise%E7%9B%B8%E5%85%B3%E9%A2%98%E7%9B%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Syivsy-Apep">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/09/Promise%E7%9B%B8%E5%85%B3%E9%A2%98%E7%9B%AE/" class="post-title-link" itemprop="url">Promiseç›¸å…³é¢˜ç›®</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-12-09 13:09:56 / ä¿®æ”¹æ—¶é—´ï¼š15:10:12" itemprop="dateCreated datePublished" datetime="2021-12-09T13:09:56+08:00">2021-12-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Promise%E5%90%88%E9%9B%86/" itemprop="url" rel="index"><span itemprop="name">Promiseåˆé›†</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="çº¢ç»¿ç¯é¢è¯•é¢˜ç›®ï¼ˆPromise-é˜Ÿåˆ—å®ç°ï¼‰"><a href="#çº¢ç»¿ç¯é¢è¯•é¢˜ç›®ï¼ˆPromise-é˜Ÿåˆ—å®ç°ï¼‰" class="headerlink" title="çº¢ç»¿ç¯é¢è¯•é¢˜ç›®ï¼ˆPromise, é˜Ÿåˆ—å®ç°ï¼‰"></a>çº¢ç»¿ç¯é¢è¯•é¢˜ç›®ï¼ˆPromise, é˜Ÿåˆ—å®ç°ï¼‰</h3><p>çº¢ç¯ä¸‰ç§’äº®ä¸€æ¬¡ï¼Œé»„ç¯1ç§’äº®ä¸€æ¬¡ï¼Œç»¿ç¯2ç§’äº®ä¸€æ¬¡ï¼Œï¼Œå¦‚ä½•è®©ä¸‰ä¸ªç¯ä¸æ–­äº¤æ›¿é‡å¤äº®ç¯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//è§£é¢˜</span><br><span class="line">const red = () =&gt; &#123;console.log(<span class="string">&#x27;red&#x27;</span>)&#125;;</span><br><span class="line">const green = () =&gt; &#123;console.log(<span class="string">&#x27;green&#x27;</span>)&#125;;</span><br><span class="line">const yellow = () =&gt; &#123;console.log(<span class="string">&#x27;yellow&#x27;</span>)&#125;;</span><br><span class="line"></span><br><span class="line">const light = <span class="keyword">function</span>(callback,time)&#123;</span><br><span class="line">  <span class="built_in">return</span> new Promise((resolve,reject)=&gt;&#123;</span><br><span class="line">    setTimeout(()=&gt;&#123;</span><br><span class="line">      callback();</span><br><span class="line">      resolve();</span><br><span class="line">    &#125;,time)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;;</span><br><span class="line">const step = () =&gt;&#123;</span><br><span class="line">  Promise.resolve().<span class="keyword">then</span>(()=&gt;&#123;<span class="built_in">return</span> light(red,3000)&#125;).<span class="keyword">then</span>(()=&gt;&#123;<span class="built_in">return</span> light(yellow,1000)&#125;).<span class="keyword">then</span>(()=&gt;&#123;<span class="built_in">return</span> light(green,2000)&#125;).<span class="keyword">then</span>(()=&gt;&#123;step()&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syivsy-apep.github.io/2021/12/09/%E6%9C%80%E7%AE%80%E5%AE%9E%E7%8E%B0Promise/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Syivsy-Apep">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/09/%E6%9C%80%E7%AE%80%E5%AE%9E%E7%8E%B0Promise/" class="post-title-link" itemprop="url">æœ€ç®€å®ç°Promise(20è¡Œ)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-12-09 11:31:50 / ä¿®æ”¹æ—¶é—´ï¼š11:58:05" itemprop="dateCreated datePublished" datetime="2021-12-09T11:31:50+08:00">2021-12-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Promise%E5%90%88%E9%9B%86/" itemprop="url" rel="index"><span itemprop="name">Promiseåˆé›†</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="æœ€ç®€å®ç°Promiseï¼Œæ”¯æŒå¼‚æ­¥é“¾å¼è°ƒç”¨ï¼ˆ20è¡Œï¼‰"><a href="#æœ€ç®€å®ç°Promiseï¼Œæ”¯æŒå¼‚æ­¥é“¾å¼è°ƒç”¨ï¼ˆ20è¡Œï¼‰" class="headerlink" title="æœ€ç®€å®ç°Promiseï¼Œæ”¯æŒå¼‚æ­¥é“¾å¼è°ƒç”¨ï¼ˆ20è¡Œï¼‰"></a>æœ€ç®€å®ç°Promiseï¼Œæ”¯æŒå¼‚æ­¥é“¾å¼è°ƒç”¨ï¼ˆ20è¡Œï¼‰</h1><p>è¿™ä¸ª Promise çš„å®ç°ä¸è€ƒè™‘ä»»ä½•å¼‚å¸¸æƒ…å†µï¼Œåªè€ƒè™‘ä»£ç æœ€ç®€çŸ­; </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">function Promise(executor)&#123;</span><br><span class="line">  this.callbacks &#x3D; [];&#x2F;&#x2F; Promise resolveæ—¶çš„å›è°ƒå‡½æ•°é›†</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F;ä¼ é€’ç»™Promiseå¤„ç†å‡½æ•°çš„resolve</span><br><span class="line">  &#x2F;&#x2F; è¿™é‡Œç›´æ¥å¾€å®ä¾‹ä¸ŠæŒ‚ä¸ªdata</span><br><span class="line">  &#x2F;&#x2F; ç„¶åæŠŠcallbackæ•°ç»„é‡Œçš„å‡½æ•°ä¾æ¬¡æ‰§è¡Œä¸€éå°±å¯ä»¥</span><br><span class="line">  const resolve &#x3D; (value) &#x3D;&gt; &#123;</span><br><span class="line">    setTimeout(()&#x3D;&gt;&#123;</span><br><span class="line">      this.data &#x3D; value;</span><br><span class="line">      this.callbacks.forEach((cb)&#x3D;&gt;cb(value))</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F; æ‰§è¡Œç”¨æˆ·ä¼ å…¥çš„å‡½æ•° </span><br><span class="line">  &#x2F;&#x2F; å¹¶ä¸”æŠŠresolveæ–¹æ³•äº¤ç»™ç”¨æˆ·æ‰§è¡Œ</span><br><span class="line">  executor(resolve);</span><br><span class="line">&#125;</span><br><span class="line">Promise.prototype.then &#x3D; function (onResolved)&#123;</span><br><span class="line">  onResolved &#x3D; typeof onResolved &#x3D;&#x3D;&#x3D; &#39;function&#39; ? onResolved : function(v) &#123;return v&#125;</span><br><span class="line">  return new Promise((resolve)&#x3D;&gt;&#123;</span><br><span class="line">    this.callbacks.push(() &#x3D;&gt; &#123;</span><br><span class="line">       const res &#x3D; onResolved(this.data);</span><br><span class="line">    if (res instanceof Promise) &#123;</span><br><span class="line">        res.then(resolve);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        resolve(res);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“æœ:</p>
<ol>
<li>500ms åè¾“å‡º 1</li>
<li>500ms åè¾“å‡º 2</li>
</ol>
<h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844904094079926286">æœ€ç®€å®ç°Promiseï¼Œæ”¯æŒå¼‚æ­¥é“¾å¼è°ƒç”¨</a></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syivsy-apep.github.io/2021/12/09/%E5%89%96%E6%9E%90Promise%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Syivsy-Apep">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Syivsy-Apepçš„å‰ç«¯åšå®¢ç«™">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/09/%E5%89%96%E6%9E%90Promise%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84/" class="post-title-link" itemprop="url">å‰–æPromiseå†…éƒ¨ç»“æ„</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-12-09 11:22:07 / ä¿®æ”¹æ—¶é—´ï¼š13:03:19" itemprop="dateCreated datePublished" datetime="2021-12-09T11:22:07+08:00">2021-12-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Promise%E5%90%88%E9%9B%86/" itemprop="url" rel="index"><span itemprop="name">Promiseåˆé›†</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Promiseæ ‡å‡†è§£è¯»"><a href="#Promiseæ ‡å‡†è§£è¯»" class="headerlink" title="Promiseæ ‡å‡†è§£è¯»"></a>Promiseæ ‡å‡†è§£è¯»</h1><ol>
<li>åªè¦ä¸€ä¸ª <code>then</code> æ–¹æ³•ï¼Œæ²¡æœ‰ <code>catch</code>ï¼Œ<code>race</code>ï¼Œ<code>all</code> ç­‰æ–¹æ³•ï¼Œä¹Ÿæ²¡æœ‰æ„é€ å‡½æ•°<br>Promiseæ ‡å‡†ä¸­ä»…æŒ‡å®šäº†Promiseå¯¹è±¡ä¸­çš„ <code>then</code> æ–¹æ³•ï¼Œæ— å…¶ä»–é‡‡å¸¸ç”¨æ–¹æ³•ï¼Œç”šè‡³ä¹Ÿæ²¡æœ‰æŒ‡å®šè¯¥å¦‚ä½•æ„é€ å‡ºä¸€ä¸ªPromiseå¯¹è±¡ã€‚</li>
<li><code>then</code> æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„Promise<br>Promiseçš„ <code>then</code> æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„Promiseï¼Œè€Œä¸æ˜¯è¿”å›this, </li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">let promise1 &#x3D; new Promise((resolve, reject)&#x3D;&gt;&#123;&#125;); </span><br><span class="line">promise2 &#x3D; promise1.then(alert);</span><br><span class="line">promise2 !&#x3D; promise1 &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>ä¸åŒPromise çš„å®ç°éœ€è¦å¯ä»¥äº’ç›¸è°ƒç”¨</li>
<li>Promise çš„åˆå§‹çŠ¶æ€ä¸º<code>pending</code>,å®ƒå¯ä»¥ç”±æ­¤çŠ¶æ€è½¬æ¢ä¸º<code>resolved</code>æˆ–è€…<code>rejected</code>ï¼Œä¸€æ—¦çŠ¶æ€ç¡®å®šï¼Œå°±ä¸å¯ä»¥å†æ¬¡è½¬æ¢ä¸ºå…¶å®ƒçŠ¶æ€ï¼ŒçŠ¶æ€ç¡®å®šçš„è¿‡ç¨‹ç§°ä¸ºsettleï¼›Promiseå¿…é¡»å¤„äº<code>pending</code>,<code>resolved</code>,<code>rejected</code>ä¸‰ä¸ªçŠ¶æ€ä¹‹ä¸€<ul>
<li><code>pending</code>ï¼šåˆå§‹çŠ¶æ€ï¼Œå®Œæˆæˆ–å¤±è´¥çŠ¶æ€çš„å‰ä¸€ä¸ªçŠ¶æ€</li>
<li><code>resolved</code>ï¼šæ“ä½œæˆåŠŸå®Œæˆ, å¹¶ä¸”æœ‰ä¸€ä¸ªæ— æ³•æ”¹å˜value</li>
<li><code>rejected</code>ï¼šæ“ä½œå¤±è´¥, å¹¶ä¸”æœ‰ä¸€ä¸ªæ— æ³•æ”¹å˜çš„reason(ä¸€èˆ¬ä¸ºä¸€ä¸ªError)</li>
</ul>
</li>
</ol>
<h1 id="å®ç°ä¸€ä¸ªPromise"><a href="#å®ç°ä¸€ä¸ªPromise" class="headerlink" title="å®ç°ä¸€ä¸ªPromise"></a>å®ç°ä¸€ä¸ªPromise</h1><h2 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h2><p>å› ä¸ºæ ‡å‡†å¹¶æ²¡æœ‰æŒ‡å®šå¦‚ä½•æ„é€ ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬åŒæ ·ä»¥ç›®å‰ä¸€èˆ¬Promiseå®ç°ä¸­é€šç”¨çš„æ–¹æ³•æ¥æ„é€ ä¸€ä¸ªPromiseå¯¹è±¡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var promise &#x3D; new Promise(function(resolve, reject) &#123;</span><br><span class="line">  &#x2F;*</span><br><span class="line">    å¦‚æœæ“ä½œæˆåŠŸï¼Œè°ƒç”¨resolveå¹¶ä¼ å…¥value</span><br><span class="line">    å¦‚æœæ“ä½œå¤±è´¥ï¼Œè°ƒç”¨rejectå¹¶ä¼ å…¥reason</span><br><span class="line">  *&#x2F;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>å®ç°æ„é€ å‡½æ•°çš„æ¡†æ¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">function Promise(executor)&#123;</span><br><span class="line">  var _this &#x3D; this;</span><br><span class="line">  _this.status &#x3D; &quot;pending&quot;;&#x2F;&#x2F;Promiseå½“å‰çŠ¶æ€</span><br><span class="line">  _this.data &#x3D; undefined;&#x2F;&#x2F;Promiseçš„å€¼</span><br><span class="line">  _this.onResolvedCallback  &#x3D; [];&#x2F;&#x2F; Promise resolveæ—¶çš„å›è°ƒå‡½æ•°é›†</span><br><span class="line">  _this.onRejectedCallback &#x3D; [] &#x2F;&#x2F; Promise rejectæ—¶çš„å›è°ƒå‡½æ•°é›†</span><br><span class="line">   &#x2F;*</span><br><span class="line">    åœ¨æ„é€ å‡½æ•°é‡Œå®šä¹‰resolveå’Œrejectè¿™ä¸¤ä¸ªå‡½æ•°</span><br><span class="line">   *&#x2F;</span><br><span class="line">  function resolve(value)&#123;</span><br><span class="line">    &#x2F;&#x2F;ToDo</span><br><span class="line">  &#125;</span><br><span class="line">  function reject(reason)&#123;</span><br><span class="line">    &#x2F;&#x2F;ToDo    </span><br><span class="line">  &#125;</span><br><span class="line">  try&#123;&#x2F;&#x2F;æ‰§è¡Œexecutorçš„è¿‡ç¨‹ä¸­æœ‰å¯èƒ½å‡ºé”™ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨try&#x2F;catchå—ç»™åŒ…èµ·æ¥ï¼Œå¹¶ä¸”åœ¨å‡ºé”™åä»¥catchåˆ°çš„å€¼rejectæ‰è¿™ä¸ªPromise</span><br><span class="line">    executor(resolve, reject)&#x2F;&#x2F; æ‰§è¡Œexecutorå¹¶ä¼ å…¥ç›¸åº”çš„å‚æ•°</span><br><span class="line">  &#125;catch(e)&#123;</span><br><span class="line">    reject(e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®ç° <code>resolve</code> å’Œ <code>reject</code> è¿™ä¸¤ä¸ªå‡½æ•°:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">function Promise(executor) &#123;</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">  function resolve(value)&#123;</span><br><span class="line">    if(_this.status &#x3D;&#x3D; &quot;pending&quot;)&#123;</span><br><span class="line">      _this.status &#x3D; &quot;resolved&quot;;</span><br><span class="line">      _this.data &#x3D; value;</span><br><span class="line">      for(let i &#x3D; 0;i &lt; _this.onResolvedCallback.lenght;i++)&#123;</span><br><span class="line">        _this.onResolvedCallback[i](value)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function reject(reason) &#123;</span><br><span class="line">    if (_this.status &#x3D;&#x3D;&#x3D; &#39;pending&#39;) &#123;</span><br><span class="line">      _this.status &#x3D; &#39;rejected&#39;</span><br><span class="line">      _this.data &#x3D; reason</span><br><span class="line">      for(var i &#x3D; 0; i &lt; _this.onRejectedCallback.length; i++) &#123;</span><br><span class="line">        _this.onRejectedCallback[i](reason)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   &#x2F;&#x2F; ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŸºæœ¬ä¸Šå°±æ˜¯åœ¨åˆ¤æ–­çŠ¶æ€ä¸ºpendingä¹‹åæŠŠçŠ¶æ€æ”¹ä¸ºç›¸åº”çš„å€¼ï¼Œå¹¶æŠŠå¯¹åº”çš„valueå’Œreasonå­˜åœ¨_thisçš„dataå±æ€§ä¸Šé¢ï¼Œä¹‹åæ‰§è¡Œç›¸åº”çš„å›è°ƒå‡½æ•°ã€‚</p>
<h2 id="then-æ–¹æ³•"><a href="#then-æ–¹æ³•" class="headerlink" title="then æ–¹æ³•"></a><code>then</code> æ–¹æ³•</h2><p>Promiseå¯¹è±¡æœ‰ä¸€ä¸ª <code>then</code> æ–¹æ³•ï¼Œç”¨æ¥æ³¨å†Œåœ¨è¿™ä¸ªPromiseçŠ¶æ€ç¡®å®šåçš„å›è°ƒï¼Œ <code>then</code> æ–¹æ³•éœ€è¦å†™åœ¨åŸå‹é“¾ä¸Šã€‚åŒæ—¶ <code>then</code> æ–¹æ³•ä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡; </p>
<p>å®ç° <code>then</code> æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; thenæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼ŒonResolvedï¼ŒonRejectedï¼Œåˆ†åˆ«ä¸ºPromiseæˆåŠŸæˆ–å¤±è´¥åçš„å›è°ƒ</span><br><span class="line">Promise.prototype.then &#x3D; function(onResolved,onRejected)&#123;</span><br><span class="line">  var _this &#x3D; this.promise2;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F;å¦‚æœthençš„å‚æ•°ä¸æ˜¯functionï¼Œåˆ™æˆ‘ä»¬éœ€è¦å¿½ç•¥å®ƒï¼Œæ­¤å¤„ä»¥å¦‚ä¸‹æ–¹å¼å¤„ç†</span><br><span class="line">  onRejected &#x3D; typeof onRejected &#x3D;&#x3D;&#x3D; &#39;function&#39; ? onRejected : function(r) &#123;&#125;</span><br><span class="line">  onResolved &#x3D; typeof onResolved &#x3D;&#x3D;&#x3D; &#39;function&#39; ? onResolved : function(v) &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  if(_this.status &#x3D;&#x3D; &quot;resolved&quot;)&#123;</span><br><span class="line">    return promise2 &#x3D; new Promise(function(resolve,reject)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  if(_this.status &#x3D;&#x3D; &quot;rejected&quot;)&#123;</span><br><span class="line">    return promise2 &#x3D; new Promise(function(resolve,rejecet)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  if(_this.status &#x3D;&#x3D; &quot;pending&quot;)&#123;</span><br><span class="line">    return promise2 &#x3D; new Promise(function(resolve,reject)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Promiseæ€»å…±æœ‰ä¸‰ç§å¯èƒ½çš„çŠ¶æ€ï¼Œåˆ†ä¸‰ä¸ªifå—æ¥å¤„ç†ï¼Œåœ¨é‡Œé¢åˆ†åˆ«éƒ½è¿”å›ä¸€ä¸ªnew Promiseã€‚<br>å¯¹äºå¦‚ä¸‹ä»£ç ï¼Œpromise2çš„å€¼å–å†³äºthené‡Œé¢å‡½æ•°çš„è¿”å›å€¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">promise2 &#x3D; promise1.then(function(value) &#123;</span><br><span class="line">  return 4</span><br><span class="line">&#125;, function(reason) &#123;</span><br><span class="line">  throw new Error(&#39;sth went wrong&#39;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœpromise1è¢«resolveäº†ï¼Œpromise2çš„å°†è¢«4 resolveï¼Œå¦‚æœpromise1è¢«rejectäº†ï¼Œpromise2å°†è¢«new Error(â€˜sth went wrongâ€™) reject</p>
<p>æ‰€ä»¥éœ€è¦åœ¨thené‡Œé¢æ‰§è¡ŒonResolvedæˆ–è€…onRejectedï¼Œå¹¶æ ¹æ®è¿”å›å€¼(æ ‡å‡†ä¸­è®°ä¸ºx)æ¥ç¡®å®špromise2çš„ç»“æœï¼Œå¹¶ä¸”ï¼Œå¦‚æœonResolved/onRejectedè¿”å›çš„æ˜¯ä¸€ä¸ªPromiseï¼Œpromise2å°†ç›´æ¥å–è¿™ä¸ªPromiseçš„ç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; thenæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼ŒonResolvedï¼ŒonRejectedï¼Œåˆ†åˆ«ä¸ºPromiseæˆåŠŸæˆ–å¤±è´¥åçš„å›è°ƒ</span><br><span class="line">Promise.prototype.then &#x3D; function(onResolved,onRejected)&#123;</span><br><span class="line">  var _this &#x3D; this,promise2;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F;å¦‚æœthençš„å‚æ•°ä¸æ˜¯functionï¼Œåˆ™æˆ‘ä»¬éœ€è¦å¿½ç•¥å®ƒï¼Œæ­¤å¤„ä»¥å¦‚ä¸‹æ–¹å¼å¤„ç†</span><br><span class="line">  onRejected &#x3D; typeof onRejected &#x3D;&#x3D;&#x3D; &#39;function&#39; ? onRejected : function(r) &#123;&#125;;</span><br><span class="line">  onResolved &#x3D; typeof onResolved &#x3D;&#x3D;&#x3D; &#39;function&#39; ? onResolved : function(v) &#123;&#125;;</span><br><span class="line">  </span><br><span class="line">  if(_this.status &#x3D;&#x3D; &quot;resolved&quot;)&#123;</span><br><span class="line">    return promise2 &#x3D; new Promise(function(resolve,reject)&#123;</span><br><span class="line">      try&#123;</span><br><span class="line">        var x &#x3D; onResolved(_this.data);</span><br><span class="line">        if(x instanceof Promise)&#123;&#x2F;&#x2F; å¦‚æœonResolvedçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œç›´æ¥å–å®ƒçš„ç»“æœåšä¸ºpromise2çš„ç»“æœ</span><br><span class="line">          x.then(resolve, reject);</span><br><span class="line">        &#125; </span><br><span class="line">        resolve(x) &#x2F;&#x2F; å¦åˆ™ï¼Œä»¥å®ƒçš„è¿”å›å€¼åšä¸ºpromise2çš„ç»“æœ</span><br><span class="line">      &#125;catch(e)&#123;</span><br><span class="line">        reject(e);&#x2F;&#x2F; å¦‚æœå‡ºé”™ï¼Œä»¥æ•è·åˆ°çš„é”™è¯¯åšä¸ºpromise2çš„ç»“æœ</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  if(_this.status &#x3D;&#x3D; &quot;rejected&quot;)&#123;</span><br><span class="line">    return promise2 &#x3D; new Promise(function(resolve,rejecet)&#123;</span><br><span class="line">      try &#123;</span><br><span class="line">        var x &#x3D; onRejected(_this.data)</span><br><span class="line">        if (x instanceof Promise) &#123;</span><br><span class="line">          x.then(resolve, reject)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; catch (e) &#123;</span><br><span class="line">        reject(e)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  if(_this.status &#x3D;&#x3D; &quot;pending&quot;)&#123;</span><br><span class="line">    &#x2F;&#x2F; å¦‚æœå½“å‰çš„Promiseè¿˜å¤„äºpendingçŠ¶æ€ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ç¡®å®šè°ƒç”¨onResolvedè¿˜æ˜¯onRejectedï¼Œ</span><br><span class="line">    &#x2F;&#x2F; åªèƒ½ç­‰åˆ°Promiseçš„çŠ¶æ€ç¡®å®šåï¼Œæ‰èƒ½ç¡®å®å¦‚ä½•å¤„ç†ã€‚</span><br><span class="line">     &#x2F;&#x2F; æ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬çš„**ä¸¤ç§æƒ…å†µ**çš„å¤„ç†é€»è¾‘åšä¸ºcallbackæ”¾å…¥promise1(æ­¤å¤„å³this&#x2F;_this)çš„å›è°ƒæ•°ç»„é‡Œ</span><br><span class="line">    return promise2 &#x3D; new Promise(function(resolve,reject)&#123;</span><br><span class="line"></span><br><span class="line">      _this.onResolvedCallback.push(function(value) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">          var x &#x3D; onResolved(_this.data)</span><br><span class="line">          if (x instanceof Promise) &#123;</span><br><span class="line">            x.then(resolve, reject)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; catch (e) &#123;</span><br><span class="line">          reject(e)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      _this.onRejectedCallback.push(function(reason) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">          var x &#x3D; onRejected(_this.data)</span><br><span class="line">          if (x instanceof Promise) &#123;</span><br><span class="line">            x.then(resolve, reject)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; catch (e) &#123;</span><br><span class="line">          reject(e)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;å®ç°ä¸€ä¸ªcatchæ–¹æ³•</span><br><span class="line">Promise.prototype.catch &#x3D; function(onRejected) &#123;</span><br><span class="line">  return this.then(null, onRejected)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å€¼çš„ç©¿é€"><a href="#å€¼çš„ç©¿é€" class="headerlink" title="å€¼çš„ç©¿é€"></a>å€¼çš„ç©¿é€</h2><p>ä¸‹é¢è¿™æ ·çš„ä»£ç ç›®å‰ä¹Ÿæ˜¯æ²¡åŠæ³•å¤„ç†çš„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">new Promise(resolve&#x3D;&gt;resolve(8))</span><br><span class="line">  .then()</span><br><span class="line">  .then()</span><br><span class="line">  .then(function foo(value) &#123;</span><br><span class="line">    alert(value)&#x2F;&#x2F;undefined</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>æ­£ç¡®çš„è¡Œä¸ºåº”è¯¥æ˜¯alertå‡º8ï¼Œè€Œå¦‚æœæ‹¿æˆ‘ä»¬çš„Promiseï¼Œè¿è¡Œä¸Šè¿°ä»£ç ï¼Œå°†ä¼šalertå‡º <code>undefined</code> ã€‚è¿™ç§è¡Œä¸ºç§°ä¸ºç©¿é€ï¼Œå³ <code>8</code> è¿™ä¸ªå€¼ä¼šç©¿é€ä¸¤ä¸ªthen(è¯´Promiseæ›´ä¸ºå‡†ç¡®)åˆ°è¾¾æœ€åä¸€ä¸ªthené‡Œçš„ <code>fooå‡½æ•°</code> é‡Œï¼Œæˆä¸ºå®ƒçš„å®å‚ï¼Œæœ€ç»ˆå°†ä¼šalertå‡º <code>8</code> ã€‚</p>
<p>é€šè¿‡è§‚å¯Ÿï¼Œä¼šå‘ç°æˆ‘ä»¬å¸Œæœ›ä¸‹é¢è¿™æ®µä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">new Promise(resolve&#x3D;&gt;resolve(8))</span><br><span class="line">  .then()</span><br><span class="line">  .catch()</span><br><span class="line">  .then(function(value) &#123;</span><br><span class="line">    alert(value)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>è·Ÿä¸‹é¢è¿™æ®µä»£ç çš„è¡Œä¸ºæ˜¯ä¸€æ ·çš„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">new Promise(resolve&#x3D;&gt;resolve(8))</span><br><span class="line">  .then(function(value)&#123;</span><br><span class="line">    return value</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(function(reason)&#123;</span><br><span class="line">    throw reason</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(function(value) &#123;</span><br><span class="line">    alert(value)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥å¦‚æœæƒ³è¦æŠŠthençš„å®å‚ç•™ç©ºä¸”è®©å€¼å¯ä»¥ç©¿é€åˆ°åé¢ï¼Œæ„å‘³ç€thençš„ä¸¤ä¸ªå‚æ•°çš„é»˜è®¤å€¼åˆ†åˆ«ä¸º <code>function(value) &#123;return value&#125;ï¼Œfunction(reason) &#123;throw reason&#125;</code> ã€‚<br>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æŠŠthené‡Œåˆ¤æ–­onResolvedå’ŒonRejectedçš„éƒ¨åˆ†æ”¹æˆå¦‚ä¸‹å³å¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">onResolved &#x3D; typeof onResolved &#x3D;&#x3D;&#x3D; &#39;function&#39; ? onResolved : function(value) &#123;return value&#125;;</span><br><span class="line">onRejected &#x3D; typeof onRejected &#x3D;&#x3D;&#x3D; &#39;function&#39; ? onRejected : function(reason) &#123;throw reason&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="Promiseç¥å¥‡çš„å€¼çš„ç©¿é€ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé»‘é­”æ³•ï¼Œåªä¸è¿‡æ˜¯thené»˜è®¤å‚æ•°å°±æ˜¯æŠŠå€¼å¾€åä¼ æˆ–è€…æŠ›"><a href="#Promiseç¥å¥‡çš„å€¼çš„ç©¿é€ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé»‘é­”æ³•ï¼Œåªä¸è¿‡æ˜¯thené»˜è®¤å‚æ•°å°±æ˜¯æŠŠå€¼å¾€åä¼ æˆ–è€…æŠ›" class="headerlink" title="Promiseç¥å¥‡çš„å€¼çš„ç©¿é€ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé»‘é­”æ³•ï¼Œåªä¸è¿‡æ˜¯thené»˜è®¤å‚æ•°å°±æ˜¯æŠŠå€¼å¾€åä¼ æˆ–è€…æŠ›"></a>Promiseç¥å¥‡çš„å€¼çš„ç©¿é€ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé»‘é­”æ³•ï¼Œåªä¸è¿‡æ˜¯thené»˜è®¤å‚æ•°å°±æ˜¯æŠŠå€¼å¾€åä¼ æˆ–è€…æŠ›</h5><h2 id="ä¸åŒPromiseçš„äº¤äº’"><a href="#ä¸åŒPromiseçš„äº¤äº’" class="headerlink" title="ä¸åŒPromiseçš„äº¤äº’"></a>ä¸åŒPromiseçš„äº¤äº’</h2><p>å»ºè®®å„ä½å¯¹ç…§ç€æ ‡å‡†é˜…è¯»ä»¥ä¸‹ä»£ç ï¼Œå› ä¸ºæ ‡å‡†å¯¹æ­¤è¯´æ˜çš„éå¸¸è¯¦ç»†ï¼Œæ‰€ä»¥ä½ åº”è¯¥èƒ½å¤Ÿåœ¨ä»»æ„ä¸€ä¸ªPromiseå®ç°ä¸­æ‰¾åˆ°ç±»ä¼¼çš„ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">resolvePromiseå‡½æ•°å³ä¸ºæ ¹æ®xçš„å€¼æ¥å†³å®špromise2çš„çŠ¶æ€çš„å‡½æ•°</span><br><span class="line">ä¹Ÿå³æ ‡å‡†ä¸­çš„[Promise Resolution Procedure](https:&#x2F;&#x2F;promisesaplus.com&#x2F;#point-47)</span><br><span class="line">xä¸º&#96;promise2 &#x3D; promise1.then(onResolved, onRejected)&#96;é‡Œ&#96;onResolved&#x2F;onRejected&#96;çš„è¿”å›å€¼</span><br><span class="line">&#96;resolve&#96;å’Œ&#96;reject&#96;å®é™…ä¸Šæ˜¯&#96;promise2&#96;çš„&#96;executor&#96;çš„ä¸¤ä¸ªå®å‚ï¼Œå› ä¸ºå¾ˆéš¾æŒ‚åœ¨å…¶å®ƒçš„åœ°æ–¹ï¼Œæ‰€ä»¥ä¸€å¹¶ä¼ è¿›æ¥ã€‚</span><br><span class="line">ç›¸ä¿¡å„ä½ä¸€å®šå¯ä»¥å¯¹ç…§æ ‡å‡†æŠŠæ ‡å‡†è½¬æ¢æˆä»£ç ï¼Œè¿™é‡Œå°±åªæ ‡å‡ºä»£ç åœ¨æ ‡å‡†ä¸­å¯¹åº”çš„ä½ç½®ï¼Œåªåœ¨å¿…è¦çš„åœ°æ–¹åšä¸€äº›è§£é‡Š</span><br><span class="line">*&#x2F;</span><br><span class="line">function resolvePromise(promise2, x, resolve, reject) &#123;</span><br><span class="line">  var then</span><br><span class="line">  var thenCalledOrThrow &#x3D; false</span><br><span class="line"></span><br><span class="line">  if (promise2 &#x3D;&#x3D;&#x3D; x) &#123; &#x2F;&#x2F; å¯¹åº”æ ‡å‡†2.3.1èŠ‚</span><br><span class="line">    return reject(new TypeError(&#39;Chaining cycle detected for promise!&#39;))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (x instanceof Promise) &#123; &#x2F;&#x2F; å¯¹åº”æ ‡å‡†2.3.2èŠ‚</span><br><span class="line">    &#x2F;&#x2F; å¦‚æœxçš„çŠ¶æ€è¿˜æ²¡æœ‰ç¡®å®šï¼Œé‚£ä¹ˆå®ƒæ˜¯æœ‰å¯èƒ½è¢«ä¸€ä¸ªthenableå†³å®šæœ€ç»ˆçŠ¶æ€å’Œå€¼çš„</span><br><span class="line">    &#x2F;&#x2F; æ‰€ä»¥è¿™é‡Œéœ€è¦åšä¸€ä¸‹å¤„ç†ï¼Œè€Œä¸èƒ½ä¸€æ¦‚çš„ä»¥ä¸ºå®ƒä¼šè¢«ä¸€ä¸ªâ€œæ­£å¸¸â€çš„å€¼resolve</span><br><span class="line">    if (x.status &#x3D;&#x3D;&#x3D; &#39;pending&#39;) &#123;</span><br><span class="line">      x.then(function(value) &#123;</span><br><span class="line">        resolvePromise(promise2, value, resolve, reject)</span><br><span class="line">      &#125;, reject)</span><br><span class="line">    &#125; else &#123; &#x2F;&#x2F; ä½†å¦‚æœè¿™ä¸ªPromiseçš„çŠ¶æ€å·²ç»ç¡®å®šäº†ï¼Œé‚£ä¹ˆå®ƒè‚¯å®šæœ‰ä¸€ä¸ªâ€œæ­£å¸¸â€çš„å€¼ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªthenableï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥å–å®ƒçš„çŠ¶æ€</span><br><span class="line">      x.then(resolve, reject)</span><br><span class="line">    &#125;</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if ((x !&#x3D;&#x3D; null) &amp;&amp; ((typeof x &#x3D;&#x3D;&#x3D; &#39;object&#39;) || (typeof x &#x3D;&#x3D;&#x3D; &#39;function&#39;))) &#123; &#x2F;&#x2F; 2.3.3</span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">      &#x2F;&#x2F; 2.3.3.1 å› ä¸ºx.thenæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªgetterï¼Œè¿™ç§æƒ…å†µä¸‹å¤šæ¬¡è¯»å–å°±æœ‰å¯èƒ½äº§ç”Ÿå‰¯ä½œç”¨</span><br><span class="line">      &#x2F;&#x2F; å³è¦åˆ¤æ–­å®ƒçš„ç±»å‹ï¼Œåˆè¦è°ƒç”¨å®ƒï¼Œè¿™å°±æ˜¯ä¸¤æ¬¡è¯»å–</span><br><span class="line">      then &#x3D; x.then </span><br><span class="line">      if (typeof then &#x3D;&#x3D;&#x3D; &#39;function&#39;) &#123; &#x2F;&#x2F; 2.3.3.3</span><br><span class="line">        then.call(x, function rs(y) &#123; &#x2F;&#x2F; 2.3.3.3.1</span><br><span class="line">          if (thenCalledOrThrow) return &#x2F;&#x2F; 2.3.3.3.3 å³è¿™ä¸‰å¤„è°é€‰æ‰§è¡Œå°±ä»¥è°çš„ç»“æœä¸ºå‡†</span><br><span class="line">          thenCalledOrThrow &#x3D; true</span><br><span class="line">          return resolvePromise(promise2, y, resolve, reject) &#x2F;&#x2F; 2.3.3.3.1</span><br><span class="line">        &#125;, function rj(r) &#123; &#x2F;&#x2F; 2.3.3.3.2</span><br><span class="line">          if (thenCalledOrThrow) return &#x2F;&#x2F; 2.3.3.3.3 å³è¿™ä¸‰å¤„è°é€‰æ‰§è¡Œå°±ä»¥è°çš„ç»“æœä¸ºå‡†</span><br><span class="line">          thenCalledOrThrow &#x3D; true</span><br><span class="line">          return reject(r)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; else &#123; &#x2F;&#x2F; 2.3.3.4</span><br><span class="line">        resolve(x)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; catch (e) &#123; &#x2F;&#x2F; 2.3.3.2</span><br><span class="line">      if (thenCalledOrThrow) return &#x2F;&#x2F; 2.3.3.3.3 å³è¿™ä¸‰å¤„è°é€‰æ‰§è¡Œå°±ä»¥è°çš„ç»“æœä¸ºå‡†</span><br><span class="line">      thenCalledOrThrow &#x3D; true</span><br><span class="line">      return reject(e)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; else &#123; &#x2F;&#x2F; 2.3.4</span><br><span class="line">    resolve(x)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹æˆ‘ä»¬çš„ä»£ç åšä¸€ç‚¹å˜åŠ¨ï¼Œå³åœ¨å››ä¸ªåœ°æ–¹åŠ ä¸ŠsetTimeout(fn, 0)</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®ç°äº†ä¸€ä¸ªçš„Promiseï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">  module.exports &#x3D; Promise</span><br><span class="line">&#125; catch (e) &#123;&#125;</span><br><span class="line"></span><br><span class="line">function Promise(executor) &#123;</span><br><span class="line">  var _this &#x3D; this</span><br><span class="line"></span><br><span class="line">  _this.status &#x3D; &#39;pending&#39;</span><br><span class="line">  _this.onResolvedCallback &#x3D; []</span><br><span class="line">  _this.onRejectedCallback &#x3D; []</span><br><span class="line"></span><br><span class="line">  function resolve(value) &#123;</span><br><span class="line">    if (value instanceof Promise) &#123;</span><br><span class="line">      return value.then(resolve, reject)</span><br><span class="line">    &#125;</span><br><span class="line">    setTimeout(function() &#123; &#x2F;&#x2F; å¼‚æ­¥æ‰§è¡Œæ‰€æœ‰çš„å›è°ƒå‡½æ•°</span><br><span class="line">      if (_this.status &#x3D;&#x3D;&#x3D; &#39;pending&#39;) &#123;</span><br><span class="line">        _this.status &#x3D; &#39;resolved&#39;</span><br><span class="line">        _this.data &#x3D; value</span><br><span class="line">        for (var i &#x3D; 0; i &lt; _this.onResolvedCallback.length; i++) &#123;</span><br><span class="line">          _this.onResolvedCallback[i](value)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function reject(reason) &#123;</span><br><span class="line">    setTimeout(function() &#123; &#x2F;&#x2F; å¼‚æ­¥æ‰§è¡Œæ‰€æœ‰çš„å›è°ƒå‡½æ•°</span><br><span class="line">      if (_this.status &#x3D;&#x3D;&#x3D; &#39;pending&#39;) &#123;</span><br><span class="line">        _this.status &#x3D; &#39;rejected&#39;</span><br><span class="line">        _this.data &#x3D; reason</span><br><span class="line">        for (var i &#x3D; 0; i &lt; _this.onRejectedCallback.length; i++) &#123;</span><br><span class="line">          _this.onRejectedCallback[i](reason)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  try &#123;</span><br><span class="line">    executor(resolve, reject)</span><br><span class="line">  &#125; catch (reason) &#123;</span><br><span class="line">    reject(reason)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function resolvePromise(promise2, x, resolve, reject) &#123;</span><br><span class="line">  var then</span><br><span class="line">  var thenCalledOrThrow &#x3D; false</span><br><span class="line"></span><br><span class="line">  if (promise2 &#x3D;&#x3D;&#x3D; x) &#123;</span><br><span class="line">    return reject(new TypeError(&#39;Chaining cycle detected for promise!&#39;))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (x instanceof Promise) &#123;</span><br><span class="line">    if (x.status &#x3D;&#x3D;&#x3D; &#39;pending&#39;) &#123; &#x2F;&#x2F;because x could resolved by a Promise Object</span><br><span class="line">      x.then(function(v) &#123;</span><br><span class="line">        resolvePromise(promise2, v, resolve, reject)</span><br><span class="line">      &#125;, reject)</span><br><span class="line">    &#125; else &#123; &#x2F;&#x2F;but if it is resolved, it will never resolved by a Promise Object but a static value;</span><br><span class="line">      x.then(resolve, reject)</span><br><span class="line">    &#125;</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if ((x !&#x3D;&#x3D; null) &amp;&amp; ((typeof x &#x3D;&#x3D;&#x3D; &#39;object&#39;) || (typeof x &#x3D;&#x3D;&#x3D; &#39;function&#39;))) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      then &#x3D; x.then &#x2F;&#x2F;because x.then could be a getter</span><br><span class="line">      if (typeof then &#x3D;&#x3D;&#x3D; &#39;function&#39;) &#123;</span><br><span class="line">        then.call(x, function rs(y) &#123;</span><br><span class="line">          if (thenCalledOrThrow) return</span><br><span class="line">          thenCalledOrThrow &#x3D; true</span><br><span class="line">          return resolvePromise(promise2, y, resolve, reject)</span><br><span class="line">        &#125;, function rj(r) &#123;</span><br><span class="line">          if (thenCalledOrThrow) return</span><br><span class="line">          thenCalledOrThrow &#x3D; true</span><br><span class="line">          return reject(r)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        resolve(x)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">      if (thenCalledOrThrow) return</span><br><span class="line">      thenCalledOrThrow &#x3D; true</span><br><span class="line">      return reject(e)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    resolve(x)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Promise.prototype.then &#x3D; function(onResolved, onRejected) &#123;</span><br><span class="line">  var _this &#x3D; this</span><br><span class="line">  var promise2</span><br><span class="line">  onResolved &#x3D; typeof onResolved &#x3D;&#x3D;&#x3D; &#39;function&#39; ? onResolved : function(v) &#123;</span><br><span class="line">    return v</span><br><span class="line">  &#125;</span><br><span class="line">  onRejected &#x3D; typeof onRejected &#x3D;&#x3D;&#x3D; &#39;function&#39; ? onRejected : function(r) &#123;</span><br><span class="line">    throw r</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (_this.status &#x3D;&#x3D;&#x3D; &#39;resolved&#39;) &#123;</span><br><span class="line">    return promise2 &#x3D; new Promise(function(resolve, reject) &#123;</span><br><span class="line">      setTimeout(function() &#123; &#x2F;&#x2F; å¼‚æ­¥æ‰§è¡ŒonResolved</span><br><span class="line">        try &#123;</span><br><span class="line">          var x &#x3D; onResolved(_this.data)</span><br><span class="line">          resolvePromise(promise2, x, resolve, reject)</span><br><span class="line">        &#125; catch (reason) &#123;</span><br><span class="line">          reject(reason)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (_this.status &#x3D;&#x3D;&#x3D; &#39;rejected&#39;) &#123;</span><br><span class="line">    return promise2 &#x3D; new Promise(function(resolve, reject) &#123;</span><br><span class="line">      setTimeout(function() &#123; &#x2F;&#x2F; å¼‚æ­¥æ‰§è¡ŒonRejected</span><br><span class="line">        try &#123;</span><br><span class="line">          var x &#x3D; onRejected(_this.data)</span><br><span class="line">          resolvePromise(promise2, x, resolve, reject)</span><br><span class="line">        &#125; catch (reason) &#123;</span><br><span class="line">          reject(reason)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (_this.status &#x3D;&#x3D;&#x3D; &#39;pending&#39;) &#123;</span><br><span class="line">    &#x2F;&#x2F; è¿™é‡Œä¹‹æ‰€ä»¥æ²¡æœ‰å¼‚æ­¥æ‰§è¡Œï¼Œæ˜¯å› ä¸ºè¿™äº›å‡½æ•°å¿…ç„¶ä¼šè¢«resolveæˆ–rejectè°ƒç”¨ï¼Œè€Œresolveæˆ–rejectå‡½æ•°é‡Œçš„å†…å®¹å·²æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œæ„é€ å‡½æ•°é‡Œçš„å®šä¹‰</span><br><span class="line">    return promise2 &#x3D; new Promise(function(resolve, reject) &#123;</span><br><span class="line">      _this.onResolvedCallback.push(function(value) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">          var x &#x3D; onResolved(value)</span><br><span class="line">          resolvePromise(promise2, x, resolve, reject)</span><br><span class="line">        &#125; catch (r) &#123;</span><br><span class="line">          reject(r)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      _this.onRejectedCallback.push(function(reason) &#123;</span><br><span class="line">          try &#123;</span><br><span class="line">            var x &#x3D; onRejected(reason)</span><br><span class="line">            resolvePromise(promise2, x, resolve, reject)</span><br><span class="line">          &#125; catch (r) &#123;</span><br><span class="line">            reject(r)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Promise.prototype.catch &#x3D; function(onRejected) &#123;</span><br><span class="line">  return this.then(null, onRejected)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Promise.deferred &#x3D; Promise.defer &#x3D; function() &#123;</span><br><span class="line">  var dfd &#x3D; &#123;&#125;</span><br><span class="line">  dfd.promise &#x3D; new Promise(function(resolve, reject) &#123;</span><br><span class="line">    dfd.resolve &#x3D; resolve</span><br><span class="line">    dfd.reject &#x3D; reject</span><br><span class="line">  &#125;)</span><br><span class="line">  return dfd</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><p>å¦‚ä½•ç¡®å®šæˆ‘ä»¬å®ç°çš„Promiseç¬¦åˆæ ‡å‡†å‘¢ï¼ŸPromiseæœ‰ä¸€ä¸ªé…å¥—çš„æµ‹è¯•è„šæœ¬ï¼Œåªéœ€è¦æˆ‘ä»¬åœ¨ä¸€ä¸ªCommonJSçš„æ¨¡å—ä¸­æš´éœ²ä¸€ä¸ªdeferredæ–¹æ³•ï¼ˆå³exports.deferredæ–¹æ³•ï¼‰ï¼Œå°±å¯ä»¥äº†ï¼Œä»£ç è§ä¸Šè¿°ä»£ç çš„æœ€åã€‚ç„¶åæ‰§è¡Œå¦‚ä¸‹ä»£ç å³å¯æ‰§è¡Œæµ‹è¯•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i -g promises-aplus-tests</span><br><span class="line">promises-aplus-tests Promise.js</span><br></pre></td></tr></table></figure>

<h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/xieranmaya/blog/issues/3">å‰–æ Promise å†…éƒ¨ç»“æ„ï¼Œä¸€æ­¥ä¸€æ­¥å®ç°ä¸€ä¸ªå®Œæ•´çš„ã€èƒ½é€šè¿‡æ‰€æœ‰ Test case çš„ Promise ç±»</a></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Syivsy-Apep</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

      








    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  















  

  

</body>
</html>
